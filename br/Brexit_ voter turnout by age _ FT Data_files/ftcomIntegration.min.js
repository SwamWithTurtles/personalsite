var commentsFtIntegration=function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=n(1),i=n(102),r=n(103);r(i),e.exports=o},function(e,t,n){"use strict";var o=n(2),i=n(3),r=n(95),s=n(96),a=n(98),c=n(99),l=n(97);i.on("error.livefyreJs",function(){l.trackLivefyreDown()}),e.exports={init:function(e){if(!e||!e({}).jquery)throw"jQuery not provided";o.set({jQuery:e});try{a.pollForBody(function(){s.add()});var t={on:r.on,off:r.off,Widget:c,ScrollTrigger:n(100),tracking:n(97)};return t}catch(l){i.utilities.logger.error(l)}}}},function(e,t,n){"use strict";var o=n(3);e.exports=new o.utilities.EnvConfig},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";var o=n(5),i=n(6),r=n(28),s=n(39),a=n(7),c=n(40),l=n(91);i.set(s),r.setConfig("cache",!0),e.exports=c,e.exports.setConfig=function(){i.set.apply(this,arguments)},e.exports.init=function(t){return a.initDomConstruct({context:t,classNamespace:"o-comments",eventNamespace:"oComments",module:e.exports})},e.exports.utilities=a,e.exports.dataService=r,e.exports.utils=n(90),e.exports.i18n=n(93),e.exports.userDialogs=n(45),e.exports.auth=n(44),e.exports.enableLogging=function(){a.logger.enable.apply(this,arguments)},e.exports.disableLogging=function(){a.logger.disable.apply(this,arguments)},e.exports.setLoggingLevel=function(){a.logger.setLevel.apply(this,arguments)},e.exports.on=o.on,e.exports.off=o.off,document.addEventListener("o.DOMContentLoaded",function(){try{var t=document.querySelector('script[type="application/json"][data-o-comments-config]');if(t){var n=JSON.parse(t.innerHTML);e.exports.setConfig(n)}}catch(o){a.logger.log("Invalid config in the DOM.",o)}a.initDomConstruct({classNamespace:"o-comments",eventNamespace:"oComments",module:e.exports,auto:!0})}),l.loadLivefyreCore(function(e){e||Livefyre.on("beforeLoadPermalinks",function(e){e.disableModal()})})},function(e,t){"use strict";var n=function(e,t,n){document.body.addEventListener(t+"."+e,n)};t.on=function(e,t,o){"function"==typeof t&&(o=t,t="oComments"),t||(t="oComments"),document.body?n(e,t,o):document.addEventListener("o.DOMContentLoaded",function(){n(e,t,o)})};var o=function(e,t,n){document.body.removeEventListener(t+"."+e,n)};t.off=function(e,t,n){"function"==typeof t&&(n=t,t="oComments"),t||(t="oComments"),document.body?o(e,t,n):document.addEventListener("o.DOMContentLoaded",function(){o(e,t,n)})};var i=function(e,t,n){document.body.dispatchEvent(new CustomEvent(t+"."+e,{detail:n,bubbles:!0}))};t.trigger=function(e,t,n){"undefined"==typeof n&&(n=t,t="oComments"),t||(t="oComments"),document.body?i(e,t,n):document.addEventListener("o.DOMContentLoaded",function(){i(e,t,n)})}},function(e,t,n){"use strict";var o=n(7).EnvConfig;e.exports=new o},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";t.EnvConfig=n(9),t.Events=n(11),t.jsonp=n(12),t.scriptLoader=n(14),t.storageWrapper={localStorage:n(15),sessionStorage:n(17)},t.logger=n(18),t.functionSync={parallel:n(19)},t.initDomConstruct=n(20),t.dateHelper=n(22),t.merge=n(10),t.dom={ScrollMonitor:n(23),offset:n(24),windowSize:n(25)},t.cookie=n(26),t.ftUser=n(27),t.generateId=n(21)},function(e,t,n){"use strict";function o(){var e={};this.get=function(t){return t?"undefined"!=typeof e[t]?e[t]:void 0:e},this.set=function(t,n){if("string"==typeof t){if("undefined"!=typeof n){var o={};o[t]=n,e=i(e,o)}}else"object"==typeof t&&(e=i(e,t))},this.destroy=function(){e=null}}var i=n(10);e.exports=o},function(e,t){"use strict";function n(e){for(var t=arguments.length,o=n,i=void 0,r=void 0,s=void 0,a=1;t>a;a++){i=arguments[a];for(r in i)i.hasOwnProperty(r)&&(s=i[r],null!==s&&"undefined"!=typeof s&&("undefined"==typeof e[r]?e[r]=s:e[r].constructor!==Object?e[r]=s:s.constructor!==Object?e[r]=s:o(e[r],s)))}return e}e.exports=n},function(e,t){"use strict";function n(){function e(e,n,o){s[e]||(s[e]=[]),s[e].push({evt:e,type:n,args:o}),t(e)}function t(e){if(!r[e]){var n=s[e].shift();if(n){switch(r[e]=!0,n.type){case"off":a.apply(o,n.args);break;case"trigger":c.apply(o,n.args)}r[e]=!1,t(e)}}}function n(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1}var o=this,i={},r={},s={};this.on=function(e,t){"string"==typeof e&&"function"==typeof t&&(i[e]||(i[e]=[]),i[e].push({callback:t}))},this.one=function(e,t){"string"==typeof e&&"function"==typeof t&&(i[e]||(i[e]=[]),i[e].push({callback:t,once:!0}))};var a=function(e,t){var o="undefined"==typeof t,r="string"==typeof e,s="function"==typeof t;if(r&&i[e])if(o)delete i[e];else if(s){var a=n(i[e],t);a>-1&&i[e].splice(a,1)}};this.off=function(t,n){var o="undefined"==typeof t,r="undefined"==typeof n,s="string"==typeof t,a="function"==typeof n;if(o)for(var c in i)i.hasOwnProperty(c)&&e(c,"off",[c]);else s&&i[t]&&(r?e(t,"off",[t]):a&&e(t,"off",arguments))};var c=function(e,t){var n=void 0;if(i[e])for(t instanceof Array||(t=[t]),n=0;n<i[e].length;)i[e][n].callback.apply(this,t),i[e][n].once===!0?i[e].splice(n,1):n++};this.trigger=function(t){e(t,"trigger",arguments)},this.destroy=function(){i=null,r=null,s=null}}e.exports=n},function(e,t,n){"use strict";function o(e,t){var n=void 0,o=void 0,c=void 0,l=void 0,u=void 0;if("function"!=typeof t)throw"Callback not specified";return"object"!=typeof e?void t(new Error("Configuration not specified or has the wrong type.")):e.url?(o=!1,c=!1,l=function(e){try{delete window[n]}catch(i){window[n]=void 0}o||(o=!0,t(null,e))},u=function(e){try{delete window[n]}catch(i){window[n]=void 0}o||(o=!0,t(e||new Error("Timeout")))},n=a+s++,e.data?(e.url+="?"+i(e.data),e.url+="&callback="+n):e.url+="?callback="+n,e.url+="&_="+(new Date).getTime(),window[n]=function(e){c=!0,l(e)},void r(e,function(e){return e?void u(e):void setTimeout(function(){c||u()},50)})):void t(new Error("URL is not specified"))}var i=n(13),r=n(14),s=0,a="jsonp_"+Math.random().toString(36).substring(7);e.exports=o},function(e,t){"use strict";function n(e){var t=[],n=function(e,n){n="function"==typeof n?n():null===n?"":n,t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)};if("object"!=typeof e)throw"The argument is not an object.";for(var o in e)e.hasOwnProperty(o)&&n(o,e[o]);return t.join("&").replace(/%20/g,"+")}e.exports=n},function(e,t){"use strict";function n(e,t){var n=void 0,i=void 0,r=void 0,s=void 0,a=void 0,c=void 0;if("function"!=typeof t)throw"Callback not specified";if("string"==typeof e)a=e;else{if(!e||"object"!=typeof e)return void t(new Error("Configuration not specified or has the wrong type."));if(!e.url)return void t(new Error("URL is not specified"));a=e.url,e.charset&&(c=e.charset)}i=!1,r=function(e){i||(i=!0,t(e||new Error("Timeout")))},s=function(){i||(i=!0,t(null))},n=document.createElement("script"),n.async=!0,c&&(n.charset=c),n.src=a;var l=function(){n&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null)};n.onload=n.onreadystatechange=function(e,t){if(t||!n.readyState||/loaded|complete/.test(n.readyState)){if(l(),t)return void r(new Error("Aborted."));s()}},n.onerror=function(){l(),r(new Error("Error loading script."))},o.insertBefore(n,o.firstChild)}var o=document.head||document.getElementsByTagName("head")[0];e.exports=n},function(e,t,n){"use strict";var o=n(16);e.exports=new o("localStorage")},function(e,t){"use strict";var n=!1;if("undefined"!=typeof Storage)try{localStorage.setItem("test",2),localStorage.removeItem("test",2),n=!0}catch(o){}var i=null;i=n?function(e){var t=void 0;if("local"===e||"localStorage"===e)t=localStorage;else{if("session"!==e&&"sessionStorage"!==e)throw"Not valid storage type selected";t=sessionStorage}this.setItem=function(e,n){var o=void 0,i=void 0;switch(typeof n){case"string":case"boolean":o=n;break;case"number":i=parseFloat(n)===parseInt(n,10)?"int":"float",o=n.toString();break;case"array":case"object":if(n instanceof Date)i="date",o=n.getTime();else try{o=JSON.stringify(n),i="json"}catch(r){o=n.toString(),i="object"}break;default:i="unknown",o=n}o=("undefined"!=typeof i?i:typeof n)+"|"+o,t.setItem(e,o)},this.getItem=function(e){var n=void 0,o=t.getItem(e);if(o)switch(n=o.substr(0,o.indexOf("|")),o=o.substr(o.indexOf("|")+1),n){case"string":return o;case"boolean":if("true"===o)return!0;if("false"===o)return!1;return;case"date":return new Date(o);case"int":return parseInt(o,10);case"float":return parseFloat(o);case"json":return JSON.parse(o);case"object":return o;default:return o}},this.hasItem=function(e){return!!t.getItem(e)},this.removeItem=function(e){t.removeItem(e)},this.clear=function(){t.clear()},this["native"]=t,this.destroy=function(){}}:function(){this.setItem=function(){return!1},this.getItem=function(){},this.hasItem=function(){return!1},this.removeItem=function(){return!1},this.clear=function(){return!1},this["native"]=void 0,this.destroy=function(){}},e.exports=i},function(e,t,n){"use strict";var o=n(16);e.exports=new o("sessionStorage")},function(e,t){"use strict";var n=["debug","log","info","warn","error"],o=3,i=!1,r=function(e){if("function"==typeof Array.prototype.indexOf)return n.indexOf(e);for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1},s=function(){var e=window.console;return"undefined"!=typeof e&&"undefined"!=typeof e.log?function(t,r){if(i===!0&&t>=o)try{e[n[t]].apply(e,r)}catch(s){for(var a=0;a<r.length;a++)r[a]=JSON.stringify(r[a]);try{e[n[t]](r.join(" "))}catch(c){e.log(r.join(" "))}}}:function(){}}();t.debug=function(){var e=r("debug");return function(){s(e,Array.prototype.slice.apply(arguments))}}(),t.log=function(){var e=r("log");return function(){s(e,Array.prototype.slice.apply(arguments))}}(),t.info=function(){var e=r("info");return function(){s(e,Array.prototype.slice.apply(arguments))}}(),t.warn=function(){var e=r("warn");return function(){s(e,Array.prototype.slice.apply(arguments))}}(),t.error=function(){var e=r("error");return function(){s(e,Array.prototype.slice.apply(arguments))}}(),t.enable=function(){i=!0},t.disable=function(){i=!1},t.setLevel=function(e){if("string"==typeof e)if(isNaN(parseInt(e,10))){if(-1===r(e))throw"Level not exists";o=r(e)}else{if(!(e>=0&&e<=n.length-1))throw"Level out of range.";o=e}else if("number"==typeof e){if(!(e>=0&&e<=n.length-1))throw"Level out of range.";o=e}}},function(e,t){"use strict";function n(e,t){var n=void 0,o=!1,i={},r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=!1);var s=function(){var e=void 0;for(e in r)if(r.hasOwnProperty(e)&&!r[e])return!1;o||t(null,i)},a=function(n){var a=function(e,a){if(!o){if(e)return o=!0,void t({key:n,error:e});r[n]=!0,i[n]=a,s()}};if("function"==typeof e[n])e[n](a);else if("object"==typeof e[n]&&"function"==typeof e[n].func)if(e[n].hasOwnProperty("args")){var c=e[n].args;c.splice(0,1,a),e[n].func.apply(this,c)}else e[n].func(a)};for(n in e)e.hasOwnProperty(n)&&a(n)}e.exports=n},function(e,t,n){"use strict";function o(e){for(var t=e.split("-"),n=t[0],o=1;o<t.length;o++)n+=t[o].charAt(0).toUpperCase()+t[o].slice(1);return n}var i=n(21);e.exports=function(e){var t=e.context;t?t instanceof HTMLElement||(t=document.querySelector(t)):t=document.body;for(var n=t.querySelectorAll('[data-o-component="'+e.classNamespace+'"]'),r=void 0,s=void 0,a=[],c=0;c<n.length;c++)if(r=n[c],s=!r.getAttribute("data-"+e.classNamespace+"-built"),e.auto&&(s=s&&"false"!==r.getAttribute("data-"+e.classNamespace+"-auto-init")),s){var l=function(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseInt(e,10);return!isNaN(e)&&t?t:e};r.id||(r.id=e.classNamespace+"--"+i()),r.setAttribute("data-"+e.classNamespace+"-built","true");for(var u={},d=void 0,f=void 0,m=void 0,p=void 0,g=0;g<r.attributes.length;g++)if(d=r.attributes[g].name.match(new RegExp("data-"+e.classNamespace+"-config-(.*)")),d&&d.length){f=d[1].split("--"),m=u;for(var h=0;h<f.length;h++)p=o(f[h]),h===f.length-1?m[p]=l(r.attributes[g].value):m[p]||(m[p]={},m=m[p])}var v=new e.module(r,u);document.body.dispatchEvent(new CustomEvent(e.eventNamespace+".ready",{detail:{id:r.id,instance:v},bubble:!0})),a.push(v)}return a}},function(e,t){"use strict";var n=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyz",n=10*(Math.random()+1),o=0;n>o;o++)e+=t.charAt(Math.floor(Math.random()*t.length));return e};e.exports=n},function(e,t){"use strict";function n(e){return 10>e?"0"+e:e}var o={toTimestamp:function(e){return e instanceof Date?e.getTime():"string"==typeof e?new Date(e).getTime():"number"==typeof e&&parseInt(e,10).toString().length<13?1e3*e:e},toDateObject:function(e){return e instanceof Date?e:new Date(o.toTimestamp(e))},toISOString:function(e){var t=o.toDateObject(e);return t.hasOwnProperty("toISOString")?t.toISOString():t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}};e.exports=o},function(e,t){"use strict";function n(e,t){function n(e){if(r instanceof Array)for(l=0,f=0;f<r.length;f++)r[f].scrollTop>0&&(l=r[f].scrollTop);else l=r.scrollTop;(e||u!==l)&&t(l),u=l}function o(){clearTimeout(d),d=setTimeout(function(){n()},c),(new Date).getTime()-a>c&&(a=(new Date).getTime(),n(!0))}var i=e,r=e;e!==document.body&&e!==document.getElementsByTagName("html")[0]&&e!==window||(r=[document.body,document.getElementsByTagName("html")[0]],i=window);var s=!1,a=0,c=200,l=void 0,u=void 0,d=void 0,f=void 0;this.start=function(){s||(s=!0,i.addEventListener("scroll",o))},this.stop=function(){s&&(s=!1,i.removeEventListener("scroll",o))},this.destroy=function(){this.stop(),i=null,r=null,s=null,a=null,c=null,l=null,u=null,d=null,f=null},this.start.call(this)}e.exports=n},function(e,t){"use strict";e.exports=function(e){var t=0,n=0,o=e;if(o.offsetParent){do t+=o.offsetLeft,n+=o.offsetTop,o=o.offsetParent;while(o);return{left:t,top:n}}return{top:e.offsetTop,left:e.offsetLeft}}},function(e,t){"use strict";e.exports=function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0],i=e.innerWidth||o.clientWidth||n.clientWidth,r=e.innerHeight||o.clientHeight||n.clientHeight;return{width:i,height:r}}},function(e,t){"use strict";t.set=function(e,t,n){var o=void 0;if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),o="; expires="+i.toGMTString()}else o="";document.cookie=e+"="+t+o+"; path=/"},t.get=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},t.remove=function(e){t.set(e,"",-1)}},function(e,t,n){"use strict";function o(){return!!i()}function i(){var e=r.get("FTSession");return e?e:null}var r=n(26);e.exports={isLoggedIn:o,getSession:i}},function(e,t,n){e.exports=n(29)},function(e,t,n){"use strict";var o=n(30),i=n(31),r=n(34),s=n(32),a=n(35),c=n(38),l=n(7);o.set(c),t.api={getLivefyreInitConfig:i.livefyre.getInitConfig,getCommentCount:i.livefyre.getCommentCount,getAuth:i.user.getAuth,updateUser:i.user.updateUser,getComments:r.getComments,postComment:r.postComment,deleteComment:r.deleteComment,stream:{create:a.create,destroy:a.destroy}},t.cache={clear:s.clear,clearAuth:s.clearAuth,clearLivefyreInit:s.clearLivefyreInit},t.enableLogging=function(){l.logger.enable.apply(this,arguments)},t.disableLogging=function(){l.logger.disable.apply(this,arguments)},t.setLoggingLevel=function(){l.logger.setLevel.apply(this,arguments)},t.setConfig=function(){o.set.apply(this,arguments)},document.addEventListener("o.DOMContentLoaded",function(){try{var e=document.querySelector('script[type="application/json"][data-o-comment-api-config]');if(e){var n=JSON.parse(e.innerHTML);t.setConfig(n)}}catch(o){l.logger.log("Invalid config in the DOM.",o)}})},function(e,t,n){"use strict";var o=n(7).EnvConfig;e.exports=new o},function(e,t,n){"use strict";var o=n(32),i=n(33),r=n(30),s=n(7),a={};a.getInitConfig=function(e,t){if("function"!=typeof t)throw"Callbacks not provided";if(!e)throw"No configuration parameters provided";e.hasOwnProperty("articleId")||t(new Error("Article ID not provided")),e.hasOwnProperty("url")||t(new Error("Article URL not provided")),e.hasOwnProperty("elId")||t(new Error("Element ID not provided")),e.hasOwnProperty("title")||t(new Error("Article title not provided"));var n=s.ftUser.getSession(),i=!1;r.get("cache")===!0&&n&&(i=!0);var a=function(){var a={title:e.title,url:e.url,articleId:e.articleId,el:e.elId};n&&(a.sessionId=n),"undefined"!=typeof e.stream_type&&(a.stream_type=e.stream_type),"undefined"!=typeof e.section&&(a.section=e.section),"undefined"!=typeof e.tags&&(a.tags=e.tags),s.jsonp({url:r.get().suds.baseUrl+r.get().suds.endpoints.livefyre.init,data:a},function(n,r){return n?void t(n,null):void(r&&r.init?(r.init.unclassifiedArticle!==!0&&r.init.notAllowedToCreateCollection!==!0&&r.init.collectionMeta&&i&&(o.cacheInit(e.articleId,r.init),r.auth&&r.auth.token?o.cacheAuth(r.auth):o.removeAuth()),t(null,r.init)):t(new Error("No data received from SUDS."),null))})};if(i){var c=o.getInit(e.articleId);e.force!==!0&&c?(c.el=e.elId,t(null,c)):a()}else a()},a.getCommentCount=function(e,t){if("function"!=typeof t)throw"Callbacks not provided";e||t(new Error("Article ID not provided")),s.jsonp({url:r.get().suds.baseUrl+r.get().suds.endpoints.livefyre.commentCount,data:{articleId:e}},function(e,n){return e?void t(e,null):void(n&&"undefined"!=typeof n.count?t(null,n.count):t(new Error("No data received from SUDS."),null))})};var c={};c.getAuth=function(e,t){if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("Callback not provided.");var n=s.ftUser.getSession(),i=!1;r.get("cache")===!0&&n&&(i=!0);var a={};n&&(a.sessionId=n);var c=function(){s.jsonp({url:r.get().suds.baseUrl+r.get().suds.endpoints.user.getAuth,data:a},function(e,n){return e?void t(e,null):(i&&(n&&n.token?o.cacheAuth(n):o.removeAuth()),void t(null,n))})};if(i){var l=o.getAuth(n);l&&e.force!==!0?t(null,l):c()}else c()},c.updateUser=function(e,t){if("function"!=typeof t)throw new Error("Callback not provided.");if(!e||"object"!=typeof e)return void t(new Error("Settings not provided."));var n=e;n.hasOwnProperty("pseudonym")&&(n.pseudonym=i.trim(n.pseudonym));var o=s.ftUser.getSession();o&&(n.sessionId=o),!e.hasOwnProperty("pseudonym")||e.hasOwnProperty("pseudonym")&&e.pseudonym?s.jsonp({url:r.get().suds.baseUrl+r.get().suds.endpoints.user.updateUser,data:n},function(e,n){return e?void t(e,null):void(n?"ok"===n.status?t(null,n):n.error?t({sudsError:!0,error:n.error},null):t(new Error("An error occured."),null):t(new Error("No data received."),null))}):t({sudsError:!0,error:"Pseudonym is blank."},null)},e.exports={livefyre:a,user:c}},function(e,t,n){"use strict";var o=n(30),i=n(7);t.getAuth=function(){var e=i.ftUser.getSession();if(e){var t=i.storageWrapper.sessionStorage.getItem(o.get().cacheConfig.authBaseName+e);if(t){if(new Date<i.dateHelper.toDateObject(t.expires))return t;i.storageWrapper.sessionStorage.removeItem(o.get().cacheConfig.authBaseName+e)}}},t.removeAuth=function(){var e=i.ftUser.getSession();e&&i.storageWrapper.sessionStorage.removeItem(o.get().cacheConfig.authBaseName+e)},t.cacheAuth=function(e){var t=i.ftUser.getSession();if(!t)return!1;if(e.token)try{var n={};i.storageWrapper.sessionStorage.hasItem(o.get().cacheConfig.authBaseName+t)&&(n=i.storageWrapper.sessionStorage.getItem(o.get().cacheConfig.authBaseName+t));var r=i.merge({},n,e);return i.storageWrapper.sessionStorage.setItem(o.get().cacheConfig.authBaseName+t,r),!0}catch(s){i.logger.debug("Failed to save to the storage.","authObject:",e,"sessionId:",t,"Error:",s)}return!1},t.getInit=function(e){return i.storageWrapper.sessionStorage.getItem(o.get().cacheConfig.initBaseName+e)},t.cacheInit=function(e,t){try{return i.storageWrapper.sessionStorage.setItem(o.get().cacheConfig.initBaseName+e,t),!0}catch(n){i.logger.debug("Failed to save to the storage.","articleId:",e,"initObj:",t,"Error:",n)}return!1},t.removeInit=function(e){i.storageWrapper.sessionStorage.removeItem(o.get().cacheConfig.initBaseName+e)},t.clearAuth=function(){if(i.storageWrapper.sessionStorage["native"])for(var e in i.storageWrapper.sessionStorage["native"])if(i.storageWrapper.sessionStorage.hasItem(e)){var t=e.match(new RegExp(o.get().cacheConfig.authBaseName+"(.*)"));t&&t.length&&i.storageWrapper.sessionStorage.removeItem(e)}},t.clearLivefyreInit=function(){if(i.storageWrapper.sessionStorage["native"])for(var e in i.storageWrapper.sessionStorage["native"])if(i.storageWrapper.sessionStorage.hasItem(e)){var t=e.match(new RegExp(o.get().cacheConfig.initBaseName+"(.*)"));t&&t.length&&i.storageWrapper.sessionStorage.removeItem(e)}},t.clear=function(){t.clearAuth(),t.clearInit()}},function(e,t){"use strict";t.trim=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}},function(e,t,n){"use strict";function o(e,t){if("function"!=typeof t)throw new Error("Callback not provided");if(!e||"object"!=typeof e)return void t(new Error("Configuration is not provided."));if(!e.hasOwnProperty("articleId"))return void t(new Error("Article ID not provided."));if(!e.hasOwnProperty("title"))return void t(new Error("Article title not provided."));if(!e.hasOwnProperty("url"))return void t(new Error("Article url not provided."));var n=s.ftUser.getSession(),o=!1;a.get("cache")===!0&&n&&(o=!0);var i={title:e.title,url:e.url,articleId:e.articleId};"number"==typeof e.page&&(i.pageNumber=e.page),"undefined"!=typeof e.section&&(i.section=e.section),"undefined"!=typeof e.tags&&(i.tags=e.tags),n&&(i.sessionId=n),s.jsonp({url:a.get().ccs.baseUrl+a.get().ccs.endpoints.getComments,data:i},function(n,i){return n?void t(n,null):void(i&&i.collection?(i.collection.unclassifiedArticle!==!0&&o&&(i.userDetails&&i.userDetails.token?c.cacheAuth(i.userDetails):c.removeAuth()),t(null,{collection:i.collection}),e.stream===!0&&"undefined"==typeof e.page&&l.create(i.collection.collectionId,{callback:function(e){t(null,{stream:e})},lastEventId:i.collection.lastEvent})):t(new Error("No data received from CCS."),null))})}function i(e,t){if("function"!=typeof t)throw new Error("Callback not provided");if(!e||"object"!=typeof e)return void t(new Error("Configuration is not provided."));if(!e.commentBody)return void t(new Error("Content not provided."));if(!e.collectionId)return void t(new Error("Collection ID not provided."));var n={collectionId:e.collectionId,commentBody:e.commentBody},o=s.ftUser.getSession();o&&(n.sessionId=o),s.jsonp({url:a.get().ccs.baseUrl+a.get().ccs.endpoints.postComment,data:n},function(e,n){return e?void t(e):void t(null,n)})}function r(e,t){if("function"!=typeof t)throw new Error("Callback not provided");if(!e||"object"!=typeof e)return void t(new Error("Configuration is not provided."));if(!e.collectionId)return void t(new Error("Collection ID not provided."));if(!e.commentId)return void t(new Error("Comment ID not provided."));var n={collectionId:e.collectionId,commentId:e.commentId},o=s.ftUser.getSession();o&&(n.sessionId=o),s.jsonp({url:a.get().ccs.baseUrl+a.get().ccs.endpoints.deleteComment,data:n},function(e,n){return e?void t(e):void t(null,n)})}var s=n(7),a=n(30),c=n(32),l=n(35);e.exports={getComments:o,postComment:i,deleteComment:r}},function(e,t,n){"use strict";function o(e,t){function n(){if(!f){var t=new Date,o=0,r=!1,u="//"+c.get().livefyre.networkName+".stream1.fyre.co/v3.0/collection/"+e+"/"+i+"/",d=setTimeout(function(){r=!0,l.debug("oCommentApi","stream","backup restart"),m({force:!0})},3e4),m=function(e){e=e||{},l.debug("oCommentApi","stream","restart"),clearTimeout(d),r&&e.force!==!0||(r=!0,o=1e4-(new Date-t),setTimeout(function(){e.report===!0&&s.emit("streamingEvent",{eventType:"info",message:"connection restored"}),n()},0>o?0:o))};try{a.get(u,{success:function(e){try{if(e.timeout===!0)return l.debug("oCommentApi","stream","success, timeout"),void m();e.data&&y(e.data),r||(clearTimeout(d),i=e.data&&e.data.maxEventId?e.data.maxEventId:i,setTimeout(function(){l.debug("oCommentApi","stream","success, new call"),n()},0))}catch(t){s.emit("streamingEvent",{eventType:"error",message:"connection dropped",error:t}),l.debug("oCommentApi","stream","exception",t),m({report:!0})}},error:function(e){s.emit("streamingEvent",{eventType:"error",message:"connection dropped",error:e}),l.debug("oCommentApi","stream","error",e),m({report:!0})},timeout:function(){l.debug("oCommentApi","stream","timeout"),m()}})}catch(p){s.emit("streamingEvent",{eventType:"error",message:"connection dropped",error:p}),l.debug("oCommentApi","stream","exception",p),m({report:!0})}}}var o=[],i=void 0,r=[],d=!1,f=!1;t.callbacks&&t.callbacks instanceof Array&&(o=t.callbacks),t.callback&&"function"==typeof t.callback&&o.push(t.callback),"undefined"!=typeof t.lastEventId&&(i=t.lastEventId);var m=function(){var e=void 0,t=arguments,n=function(e){setTimeout(function(){e.apply(this,t)})};for(e=0;e<o.length;e++)n(o[e])},p=function(e,t){-1===r.indexOf(e.content.id)&&r.push(e.content.id),m({comment:{parentId:e.content.parentId||null,author:t?{displayName:t.displayName,tags:t.tags,type:t.type}:null,content:e.content.bodyHtml||null,timestamp:e.content.createdAt||null,commentId:e.content.id||null,visibility:e.vis}})},g=function(e,t){m({comment:{updated:!0,parentId:e.content.parentId||null,author:t?{displayName:t.displayName,tags:t.tags,type:t.type}:null,content:e.content.bodyHtml||null,timestamp:e.content.createdAt||null,commentId:e.content.id||null,visibility:e.vis,lastVisibility:e.lastVis}})},h=function(e){m({comment:{deleted:!0,commentId:e.content.id}})},v=function(e){m({collection:{commentsEnabled:e.value}})},y=function(e){if(e.states){var t=e.states;for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];0===o.type&&(o.vis>=1?o.content.updatedBy||-1!==r.indexOf(o.content.id)?g(o,e.authors&&o.content.authorId?e.authors[o.content.authorId]:null):p(o,e.authors&&o.content.authorId?e.authors[o.content.authorId]:null):0===o.vis&&h(o))}}if(e.settings&&e.settings.length){var i=0,s=void 0;for(i=0;i<e.settings.length;i++)s=e.settings[i],"commentsEnabled"===s.name&&v(s)}};this.addCallback=function(e){e&&"function"==typeof e&&o.push(e)},this.removeCallback=function(e){e&&"function"==typeof e&&-1!==o.indexOf(e)&&o.splice(o.indexOf(e),1),0===o.length&&this.destroy()},this.setLastEventId=function(e){i=e},this.init=function(){return d||f||"undefined"==typeof i||"undefined"==typeof e||!o.length?!1:(d=!0,n(),!0)},this.destroy=function(){o=null,i=null,"undefined"!=typeof u[e]&&(u[e]=void 0),f=!0}}function i(e,t){var n=void 0,i=0;if(e){if("function"==typeof t)n=t;else{if("object"!=typeof t)return!1;if("function"!=typeof t.callback)return!1;n=t.callback,t.lastEventId&&(i=t.lastEventId)}return u[e]?(u[e].addCallback(n),!0):(u[e]=new o(e,{lastEventId:i,callback:n}),u[e].init(),!0)}}function r(e,t){var n=void 0;e&&("function"==typeof t?n=t:"function"==typeof t.callback&&(n=t.callback),u[e]&&(n?u[e].removeCallback(n):u[e].destroy()))}var s=n(36),a=n(37),c=n(30),l=n(7).logger,u={};e.exports={create:i,destroy:r}},function(e,t){"use strict";t.emit=function(e,t){t=t||{eventType:"info"};try{document.body.dispatchEvent(new CustomEvent("oCommentApi."+e,{detail:t,bubbles:!0}))}catch(n){}}},function(e,t,n){"use strict";function o(e){var t=!1;if("undefined"!=typeof window.location){var n=e.match(/(http[s]?:)?\/\/([^\/]*)/);n&&n[2]!==window.location.hostname&&(t=!0)}if(t===!0)return"undefined"!=typeof(new XMLHttpRequest).withCredentials?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:!1;if(window.XMLHttpRequest&&("file:"!==window.location.protocol||!window.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(o){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(o){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(o){}return!1}var i=n(7);t.get=function(e,t){var n=o(e),r=!1;if(!n)return void t.error(new Error("No XML Http support"));var s=(new Date).getTime();e+=-1!==e.indexOf("?")?"&_="+s:"?_="+s,n instanceof XMLHttpRequest?n.open("get",e,!0):(n.open("get",e),"function"!=typeof n.hasOwnProperty&&(n.timeout=9e3)),"undefined"!==n.onload?(n.onload=function(){if(!r)if(n.status&&200!==n.status||!n.responseText)t.error(new Error(n.statusText||"Failed response."));else{var e=n.responseText;try{e=JSON.parse(e)}catch(o){}i.logger.debug("stream","xhr onload","responseText:",e),t.success(e)}},n.onerror=function(e){r||(i.logger.debug("stream","xhr onerror","xhr error"),t.error(e))},n.ontimeout=function(){if(!r){i.logger.debug("stream","xhr ontimeout","xhr timeout"),r=!0;try{n.abort()}catch(e){}t.timeout()}},n.onprogress=function(){}):n.onreadystatechange=function(){if(4===n.readyState)if(n.responseText){var e=n.responseText;try{e=JSON.parse(e)}catch(o){}i.logger.debug("stream","xhr onreadystatechange","responseText:",e),t.success(e)}else i.logger.debug("stream","xhr onreadystatechange","xhr error"),t.error()},setTimeout(function(){n.send()},0)}},function(e,t){"use strict";e.exports={suds:{baseUrl:"//session-user-data.webservices.ft.com",endpoints:{livefyre:{init:"/v1/livefyre/init",commentCount:"/v1/livefyre/commentcount"},user:{updateUser:"/v1/user/updateuser",getAuth:"/v1/user/getauth"}}},ccs:{baseUrl:"//comment-creation.webservices.ft.com",endpoints:{getComments:"/v1/getComments",postComment:"/v1/postComment",deleteComment:"/v1/deleteComment"}},cacheConfig:{authBaseName:"comments-prod-auth-",initBaseName:"comments-prod-init-"},livefyre:{networkName:"ft"}}},function(e,t){"use strict";e.exports={loginUrl:"https://accounts.ft.com/login",livefyre:{network:"ft.fyre.co",domain:"ft.auth.fyre.co",resourceDomainBase:"//cdn.livefyre.com/"},resourceUrls:{livefyreJs:"Livefyre.js"},emailNotifications:!0}},function(e,t,n){"use strict";function o(){function e(){var e=function(){p.api.getAuth(function(e,t){!e&&t&&u.showSettingsDialog(t,function(e,t){e||t&&t.token&&l.logger.debug("new settings",t)})})},t=function(){p.api.getAuth(function(e,t){!e&&t&&u.showChangePseudonymDialog(t.displayName,function(e,t){e||t&&t.token&&l.logger.debug("new settings",t)})})},n=b(function(){s.get().emailNotifications!==!0?t():e()});i.ui.addSettingsLink({onClick:function(){r.loginRequired(function(e){e||n()})}})}function t(){i.ui.removeSettingsLink()}function n(e,t){p.api.stream.create(e,{lastEventId:t,callback:o})}function o(e){e.comment&&(2===e.comment.visibility?i.ui.showCommentBanned(e.comment.commentId):2!==e.comment.lastVisibility&&e.comment.deleted!==!0||i.ui.removeCommentBanned(e.comment.commentId))}m.Widget.apply(this,arguments);var i=this;if(this.config){this.forceMode=!1,this.config.stream_type=this.config.stream_type||"livecomments",this.config.layout=this.config.layout||"main",this.config.livefyre&&"object"==typeof this.config.livefyre||(this.config.livefyre={}),this.config.livefyre.editorCss=this.config.livefyre.editorCss||"p { margin-bottom: 10px !important; }",this.config.livefyre.disableAvatars="boolean"==typeof this.config.livefyre.disableAvatars?this.config.livefyre.disableAvatars:!0,this.config.livefyre.disableIE8Shim="boolean"==typeof this.config.livefyre.disableIE8Shim?this.config.livefyre.disableIE8Shim:!0,this.config.livefyre.disableThirdPartyAnalytics="boolean"==typeof this.config.livefyre.disableThirdPartyAnalytics?this.config.livefyre.disableThirdPartyAnalytics:!0,-1===this.getWidgetEl().className.indexOf("o-comments")&&(this.getWidgetEl().className+=" o-comments"),-1===this.getWidgetEl().className.indexOf("o-comments--lf-overrides")&&(this.getWidgetEl().className+=" o-comments--lf-overrides"),-1===this.getWidgetEl().className.indexOf("o-comments--comment-type-"+i.config.stream_type)&&(this.getWidgetEl().className+=" o-comments--comment-type-"+i.config.stream_type),this.config.layout&&(this.getWidgetEl().className+=" o-comments--comment-layout-"+this.config.layout),this.getWidgetEl().setAttribute("data-o-comments-built","true"),this.config.stringOverrides=this.config.stringOverrides||{},this.ui=new a(this.getWidgetEl(),{
layout:this.config.layout,stream_type:this.config.stream_type});var v=i.config.stringOverrides?l.merge({},d.lfStringOverride,i.config.stringOverrides):d.lfStringOverride;i.config.stringOverrides=v;var y=!1;c.isLivefyreActionQueuePresent()&&(l.logger.log("Force flag set."),this.forceMode=!0);var b=function(e){return function(){y||e.apply(this,arguments)}};this.loadInitData=function(e){var t={title:i.config.title,url:i.config.url,articleId:i.config.articleId,elId:i.config.elId,stream_type:i.config.stream_type};"undefined"!=typeof i.config.section&&(t.section=i.config.section),"undefined"!=typeof i.config.tags&&(t.tags=i.config.tags),p.api.getLivefyreInitConfig(t,b(function(t,n){return t?void e(t):void e(null,n)}))},this.render=function(e,t){e&&!y&&(e.unclassifiedArticle!==!0&&e.notAllowedToCreateCollection!==!0?g.loadLivefyreCore(b(function(o){if(o)return i.trigger("error.widget",o),void i.onError(o);i.trigger("widget.ready");var a=void 0;for(a in i.config.livefyre)i.config.livefyre.hasOwnProperty(a)&&(e[a]=i.config.livefyre[a]);(i.config.authPageReload===!0||i.config.livefyre.authPageReload)&&(e.authPageReload=!0,r.authPageReload=!0);var c={network:s.get().livefyre.network};i.config.stringOverrides&&(c.strings=i.config.stringOverrides),Livefyre.require(["fyre.conv#3","auth"],b(function(o,a){a.delegate(r.getAuthDelegate()),i.ui.clearContainer(),l.logger.debug("initData passed to Livefyre",e),new o(c,[e],b(function(o){o&&!function(){t(),i.lfWidget=o,i.trigger("widget.load",{lfWidget:o}),h.trackSuccessLoad(),o.on("initialRenderComplete",b(function(){var e=i.lfWidget.getCollection().attributes;n(e.id,e.event),i.ui.addTermsAndGuidelineMessage(),s.get().emailNotifications!==!0&&i.ui.hideFollowButton(),"side"!==i.config.layout&&i.ui.moveCommentCountOut(),s.get().showEnvironment===!0&&i.ui.showEnvironment(s.get().livefyre.network),r.login(function(e,t){t||(t=null),i.trigger("data.auth",t),e?i.forceMode===!0&&setTimeout(i.ui.scrollToWidget,2e3):(r.logout(),t&&(t.pseudonym===!1?(i.forceMode===!0&&r.loginRequiredPseudonymMissing(null,!0),i.ui.hideSignInLink()):t.serviceUp===!1&&(i.ui.makeReadOnly(),i.ui.hideSignInLink(),i.ui.addAuthNotAvailableMessage(),i.ui.hideTermsAndGuidelinesMessage())))}),i.trigger("widget.renderComplete")}));var a=parseInt(e.siteId,10);o.on("commentPosted",b(function(e){r.pseudonymWasMissing?r.pseudonymWasMissing=!1:p.api.getAuth(function(e,t){return e?void(t=null):void(i.config.emailAlert!==!1&&s.get().emailNotifications===!0&&t&&"object"==typeof t&&t.token&&!t.settings&&u.showEmailAlertDialog())}),i.trigger("tracking.postComment",{siteId:a,lfEventData:e}),h.trackPost(a,e.parent),e.sharedToFacebook===!0?h.trackShare(a,"facebook"):e.sharedToTwitter===!0&&h.trackShare(a,"twitter")})),o.on("commentLiked",b(function(e){i.trigger("tracking.likeComment",{siteId:a,lfEventData:e}),h.trackLike(a)})),o.on("commentShared",b(function(e){i.trigger("tracking.shareComment",{siteId:a,lfEventData:e}),e.sharedToFacebook===!0&&h.trackShare(a,"facebook"),e.sharedToTwitter===!0&&h.trackShare(a,"twitter")})),o.on("socialMention",b(function(e){i.trigger("tracking.socialMention",{siteId:a,lfEventData:e}),h.trackLike(a,e.provider)}))}()}))}))})):e.unclassifiedArticle===!0?t({unclassifiedArticle:!0}):e.notAllowedToCreateCollection===!0&&t({notAllowedToCreateCollection:!0}))},this.onError=function(e){i.ui.clearContainer(),"object"==typeof e&&e.unclassifiedArticle!==!0&&e.notAllowedToCreateCollection!==!0&&i.ui.addNotAvailableMessage()};var w=!1;this.on("error.widget",function(e){var t=e.detail.data;(!t||t.unclassifiedArticle||t.notAllowedToCreateCollection)&&t||w||(w=!0,"undefined"==typeof Livefyre?h.trackLivefyreDown():h.trackSudsDown())}),this.on("error.init",function(){w||(w=!0,h.trackSudsDown())}),f.on("auth.login",e),f.on("auth.logout",t);var E=this.destroy;this.destroy=function(){y=!0,i.forceMode=null,i.lfWidget&&i.lfWidget.getCollection().attributes&&p.api.stream.destroy(i.lfWidget.getCollection().attributes.id,{callback:o}),i.lfWidget=null,f.off("auth.login",e),f.off("auth.logout",t),E(),E=null,i=null},this.config.autoInit!==!1&&this.init.call(this)}}var i=n(41)["default"],r=n(44),s=n(6),a=n(92),c=n(90),l=n(7),u=n(45),d=n(93),f=n(5),m=n(46),p=n(28),g=n(91),h=n(94);m.Widget.__extend(o,"oComments","o-comments"),o.__extend=function(e,t,n){if("function"==typeof i)e.prototype=i(o.prototype);else{var r=function(){};r.prototype=o.prototype,e.prototype=new r,e.prototype.constructor=e}t&&(e.prototype.eventNamespace=t),n&&(e.prototype.classNamespace=n)},e.exports=o},function(e,t,n){e.exports={"default":n(42),__esModule:!0}},function(e,t,n){var o=n(43);e.exports=function(e,t){return o.create(e,t)}},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){"use strict";function o(e){return a.storageWrapper.sessionStorage.hasItem(g)?a.storageWrapper.sessionStorage.getItem(g)===e:!1}function i(e){a.storageWrapper.sessionStorage.setItem(g,e)}function r(){a.storageWrapper.sessionStorage.removeItem(g)}function s(e){"function"!=typeof e&&(e=function(){}),l.api.getAuth({force:!0},function(n,o){o&&o.token?t.login(function(t,n){t?e(null,n):e(new Error("Not logged in."))}):o&&o.pseudonym===!1?t.loginRequiredPseudonymMissing(e):e(n||new Error("Login failed."))})}var a=n(7),c=n(45),l=n(28),u=n(90),d=n(5),f=n(91),m=n(6),p=void 0,g="o-comments-auth-last-token",h=!1;t.pseudonymMissing=!1,t.pseudonymWasMissing=!1,t.authPageReload=!1,t.getAuthDelegate=function(){return p||(p={login:function(e){t.loginRequired(function(n,r){return n?void e(n):void(r&&r.token?o(r.token)?e(null,{livefyre:r.token}):t.logout(function(){e(null,{livefyre:r.token}),i(r.token)}):(t.logout(),e(new Error("Not authenticated."))))})},logout:function(e){a.logger.debug("auth delegate logout"),d.trigger("auth.logout"),r(),l.cache.clearAuth(),e()},viewProfile:function(){},editProfile:function(){}}),p},t.login=function(e){"function"!=typeof e&&(e=function(){}),f.loadLivefyreCore(function(n){return n?(h=!1,void e(!1)):void l.api.getAuth(function(n,s){return n?(h=!1,void e(!1)):void(s?s.token?Livefyre.require(["auth"],function(t){o(s.token)||t.logout(),t.authenticate({livefyre:s.token}),i(s.token),h=!0,d.trigger("auth.login",s),e(!0,s)}):s.pseudonym===!1?(t.pseudonymMissing=!0,t.pseudonymWasMissing=!0,r(),h=!1,e(!1,s)):(h=!1,e(!1,s)):(h=!1,e(!1)))})})},t.logout=function(e){f.loadLivefyreCore(function(t){t||Livefyre.require(["auth"],function(t){t.logout(),h=!1,"function"==typeof e&&e()})})},t.loginRequiredPseudonymMissing=function(e,n){"function"!=typeof e&&(e=function(){}),a.logger.log("pseudonymMissing"),c.showSetPseudonymDialog(function(o,i){return o?(u.emptyLivefyreActionQueue(),void e(o)):(t.authPageReload!==!0||n||u.emptyLivefyreActionQueue(),void(i&&i.token?t.login(function(t,n){t?e(null,n):e(new Error("Not logged in."))}):e(new Error("Login failed."))))})},t.loginRequiredDefaultBehavior=function(){window.location.href=m.get("loginUrl")+"?location="+encodeURIComponent(document.location.href)};var v=function(e){t.loginRequiredDefaultBehavior(e.detail.callback)};t.setLoginRequiredDefaultBehavior=function(){d.off("auth.loginRequired",v),d.on("auth.loginRequired",v)},t.loginRequired=function(e){"function"!=typeof e&&(e=function(){}),l.api.getAuth(function(n,o){o&&o.pseudonym===!1?t.loginRequiredPseudonymMissing(e):o&&o.token?h?e(null):t.login(function(t,n){t?e(null,n):e(new Error("Not logged in."))}):a.ftUser.isLoggedIn()?(a.logger.log("session expired, show inactivity message"),c.showInactivityMessage({submit:function(){window.location.href=m.get("loginUrl")+"?location="+encodeURIComponent(document.location.href)},close:function(){u.emptyLivefyreActionQueue(),e(new Error("Login failed."))}})):(a.logger.log("user should log in"),t.setLoginRequiredDefaultBehavior(),d.trigger("auth.loginRequired",{callback:function(t){return t?(u.emptyLivefyreActionQueue(),void e(t||new Error("Login failed."))):void s(e)}}))})}},function(e,t,n){"use strict";function o(e,t){if(Array.prototype.indexOf)return-1!==e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function i(e){return o(m,e)}function r(e){return o(p,e)}function s(e,t){var n=[],o=[];return e.emailcomments!==t.emailcomments&&(!r(e.emailcomments)&&e.emailcomments||!i(t.emailcomments)||n.push("emailcomments"),i(e.emailcomments)&&r(t.emailcomments)&&o.push("emailcomments")),e.emailreplies!==t.emailreplies&&(!r(e.emailreplies)&&e.emailreplies||!i(t.emailreplies)||n.push("emailreplies"),i(e.emailreplies)&&r(t.emailreplies)&&o.push("emailreplies")),e.emaillikes!==t.emaillikes&&(!r(e.emaillikes)&&e.emaillikes||!i(t.emaillikes)||n.push("emaillikes"),i(e.emaillikes)&&r(t.emaillikes)&&o.push("emaillikes")),e.emailautofollow!==t.emailautofollow&&(!r(e.emailautofollow)&&e.emailautofollow||!i(t.emailautofollow)||n.push("emailautofollow"),i(e.emailautofollow)&&r(t.emailautofollow)&&o.push("emailautofollow")),{subscribes:n,unsubscribes:o}}function a(e){var t=[];return i(e.emailcomments)&&t.push("emailcomments"),i(e.emailreplies)&&t.push("emailreplies"),i(e.emaillikes)&&t.push("emaillikes"),i(e.emailautofollow)&&t.push("emailautofollow"),{subscribes:t}}var c=n(46),l=n(28),u=n(90),d=n(44),f=n(5),m=["immediately","hourly","on"],p=["never","off"];t.showSetPseudonymDialog=function(e){e=e||function(){},c.userDialogs.showSetPseudonymDialog({submit:function(t,n){t&&t.pseudonym?l.api.updateUser({pseudonym:t.pseudonym},function(t){return t?void n("object"==typeof t&&t.sudsError?c.i18n.serviceMessageOverrides.hasOwnProperty(t.error)?c.i18n.serviceMessageOverrides[t.error]:t.error:c.i18n.texts.changePseudonymError):void l.api.getAuth({force:!0},function(t,o){return t?(n(c.i18n.texts.changePseudonymError),void e(t)):(e(null,o),void n())})}):n(c.i18n.texts.changePseudonymBlankError)},close:function(){e(new Error("Closed or cancelled.")),u.emptyLivefyreActionQueue()}})},t.showChangePseudonymDialog=function(e,t){t=t||function(){},c.userDialogs.showChangePseudonymDialog(e,{submit:function(e,n){e?l.api.updateUser(e,function(e){return e?void n("object"==typeof e&&e.sudsError?c.i18n.serviceMessageOverrides.hasOwnProperty(e.error)?c.i18n.serviceMessageOverrides[e.error]:e.error:c.i18n.texts.genericError):(d.logout(),void l.api.getAuth({force:!0},function(e,o){return e?(t(e),void n(c.i18n.texts.genericError)):(d.login(),t(null,o),void n())}))}):n(c.i18n.texts.genericError)},close:function(){t(new Error("Closed or cancelled."))}})},t.showEmailAlertDialog=function(){c.userDialogs.showEmailAlertDialog({submit:function(e,t){e?l.api.updateUser(e,function(e){return e?void t("object"==typeof e&&e.sudsError?c.i18n.serviceMessageOverrides.hasOwnProperty(e.error)?c.i18n.serviceMessageOverrides[e.error]:e.error:c.i18n.texts.genericError):(d.logout(),void l.api.getAuth({force:!0},function(e,n){if(e)return void t(c.i18n.texts.genericError);d.login(),t();var o=void 0;o=a(n.settings),o.subscribes.length&&f.trigger("tracking.subscribe",o.subscribes)}))}):t(c.i18n.texts.genericError)}})},t.showSettingsDialog=function(e,t){t=t||function(){},c.userDialogs.showSettingsDialog(e,{submit:function(n,o){n?l.api.updateUser(n,function(n){return n?void o("object"==typeof n&&n.sudsError?c.i18n.serviceMessageOverrides.hasOwnProperty(n.error)?c.i18n.serviceMessageOverrides[n.error]:n.error:c.i18n.texts.genericError):(d.logout(),void l.api.getAuth({force:!0},function(n,i){if(n)return t(n),void o(c.i18n.texts.genericError);d.login(),t(null,i),o();var r=void 0;e.settings?r=s(e.settings,i.settings):(r=a(i.settings),r.unsubscribes=[]),r.subscribes.length&&f.trigger("tracking.subscribe",r.subscribes),r.unsubscribes.length&&f.trigger("tracking.unsubscribe",r.unsubscribes)}))}):o(c.i18n.texts.genericError)},close:function(){t(new Error("Closed or cancelled."))}})},t.showInactivityMessage=c.userDialogs.showInactivityMessage},function(e,t,n){e.exports=n(47)},function(e,t,n){"use strict";var o=n(7);t.Widget=n(48),t.WidgetUi=n(49),t.userDialogs=n(57),t.utils=n(56),t.i18n=n(50),t.templates=n(51),t.templatingEngine=n(52),t.enableLogging=function(){o.logger.enable.apply(this,arguments)},t.disableLogging=function(){o.logger.disable.apply(this,arguments)},t.setLoggingLevel=function(){o.logger.setLevel.apply(this,arguments)}},function(e,t,n){"use strict";function o(e,t){var n=void 0,o=void 0;o=this;try{e?e instanceof HTMLElement||(e=document.querySelector(e)):e=document.body}catch(i){var a=void 0;"string"==typeof e&&(a=document.querySelector(e)),e=a?a:document.body}if(e.setAttribute("data-"+o.classNamespace+"-js",""),n=e,n.id||(n.id=o.eventNamespace+"-"+r.generateId()),t.elId=n.id,t){if(!t.articleId){if(!t.articleid)return;t.articleId=t.articleid}t.url&&t.title&&(t.timeout=t.timeout||15,this.config=t,this.ui=new s(n),this.getWidgetEl=function(){return n},this.on=function(e,t){n.addEventListener(o.eventNamespace+"."+e,t)},this.off=function(e,t){n.removeEventListener(o.eventNamespace+"."+e,t)},this.trigger=function(e,i){var r={data:i,instance:o,id:t.elId};n.dispatchEvent(new CustomEvent(o.eventNamespace+"."+e,{detail:r,bubbles:!0}))},this.loadInitData=function(e){e(new Error("Not implemented"))},this.onTimeout=function(){o.ui.clearContainer(),o.ui.addNotAvailableMessage()},this.onError=function(){o.ui.clearContainer(),o.ui.addNotAvailableMessage()},this.destroy=function(){o.config=null,o.ui.destroy(),o.ui=null,n=null,o=null})}}var i=n(41)["default"],r=n(7),s=n(49);o.prototype.initCalled=!1,o.prototype.init=function(){var e=this,t=this;this.config&&(this.initCalled||!function(){e.initCalled=!0;var n=void 0;e.config.timeout>0&&(n=setTimeout(function(){t.trigger("widget.timeout"),t.onTimeout()},1e3*e.config.timeout)),t.loadInitData(function(e,o){return e?(t.trigger("error.init",e.error),t.trigger("error.widget",e.error),t.onError(e),void clearTimeout(n)):void(o&&(t.trigger("data.init",o),t.render(o,function(e){return e?(t.trigger("error.widget",e),t.onError(e),void clearTimeout(n)):void clearTimeout(n)})))})}())},o.prototype.eventNamespace="oCommentUi",o.prototype.classNamespace="o-comment-ui",o.__extend=function(e,t,n){if("function"==typeof i)e.prototype=i(o.prototype);else{var r=function(){};r.prototype=o.prototype,e.prototype=new r,e.prototype.constructor=e}t&&(e.prototype.eventNamespace=t),n&&(e.prototype.classNamespace=n)},e.exports=o},function(e,t,n){"use strict";function o(e){var t=this;this.widgetContainer=void 0;try{if("string"==typeof e){var n=document.querySelectorAll(e);if(!n.length)throw"Selector not valid or does not exists.";this.widgetContainer=e[0]}else(window.HTMLElement&&e instanceof window.HTMLElement||window.Element&&e instanceof window.Element)&&(this.widgetContainer=e)}catch(o){this.widgetContainer=document.body}this.scrollToWidget=function(e){var n=!1,o=function(){n||(n=!0,"function"==typeof e&&e())};window.scrollTo(0,t.widgetContainer.offsetTop),o()},this.addNotAvailableMessage=function(){t.widgetContainer.innerHTML=s.unavailableTemplate.render({message:r.texts.unavailable})},this.hideTermsAndGuidelinesMessage=function(){var e=t.widgetContainer.querySelector(".o-comment-ui--terms-message");e&&(e.style.display="none")},this.showTermsAndGuidelinesMessage=function(){var e=t.widgetContainer.querySelector(".o-comment-ui--terms-message");e&&(e.style.display="block")},this.clearContainer=function(){t.widgetContainer.innerHTML=""},this.showEnvironment=function(e){t.widgetContainer.insertBefore(a.toDOM(s.environmentDisplay.render({envName:e})),t.widgetContainer.firstChild)},this.addTermsAndGuidelineMessage=void 0,this.makeReadOnly=void 0,this.hideSignInLink=void 0,this.addAuthNotAvailableMessage=void 0,this.addSettingsLink=void 0,this.destroy=function(){t.widgetContainer&&(t.widgetContainer.parentNode.removeChild(t.widgetContainer),t.widgetContainer=null)}}var i=n(41)["default"],r=n(50),s=n(51),a=n(56);o.__extend=function(e){if("function"==typeof i)e.prototype=i(o.prototype),e.prototype=i(o.prototype);else{var t=function(){};t.prototype=o.prototype,e.prototype=new t,e.prototype.constructor=e}},e.exports=o},function(e,t){"use strict";t.texts={unavailable:"It seems we're having a problem loading comments for you. Apologies. Hopefully it's temporary, but if you continue to experience this difficulty, please contact <a href=\"mailto:help@ft.com\">help@ft.com</a>.",changePseudonymError:"System is temporarily unavailable, please try again later.",changePseudonymBlankError:"Pseudonym is blank.",genericError:"System is temporarily unavailable, please try again later.",commentingSettingsLabel:"Commenting settings"},t.serviceMessageOverrides={"User session is not valid.":'You are not currently signed in to FT.com, please <a href="https://accounts.ft.com/login?location='+encodeURIComponent(document.location.href)+'">sign in</a> to create a pseudonym',"User profile (.*) does not have permission to access the desired action.":"You don't have permission to perform this action.","Commenting is closed for conversation=([0-9]+)":"This conversation is closed to new comments."},t.serviceCodeMessages={401:"You are not authorized for this action.",403:"You are not authorized for this action.",404:"The resource was not found."}},function(e,t,n){"use strict";var o=n(52);e.exports={unavailableTemplate:o.compile('<div class="o-comment-ui--unavailable-message" style="clear: both; font-style: italic; font-size: {{fontSize}}{{^fontSize}}14px{{/fontSize}}; font-family: BentonSans, Arial; {{style}}">\r\n    {{{message}}}\r\n    {{^message}}\r\n        It seems we\'re having a problem loading comments for you. Apologies. Hopefully it\'s temporary, but if you continue to experience this difficulty, please contact <a href="mailto:help@ft.com">help@ft.com</a>.\r\n    {{/message}}\r\n</div>\r\n'),authUnavailableTemplate:o.compile('<div class="o-comment-ui--unavailable-message" style="clear: both; font-style: italic; font-size: {{fontSize}}{{^fontSize}}14px{{/fontSize}}; font-family: BentonSans, Arial; {{style}}">\r\n    {{{message}}}\r\n    {{^message}}\r\n        It seems we\'re having a problem accepting new comments. Apologies. Hopefully it\'s temporary, but if you continue to experience this difficulty, please contact <a href="mailto:help@ft.com">help@ft.com</a>.\r\n    {{/message}}\r\n</div>\r\n'),termsAndGuidelinesTemplate:o.compile('<div class="o-comment-ui--terms-message">\r\n    By submitting this comment I confirm that I have read and agreed to the\r\n    <a target="_blank" href="http://www.ft.com/servicestools/help/terms">FT Terms and Conditions</a>.\r\n    Please also see our <a target="_blank" href="http://www.ft.com/servicestools/help/comments-policy">commenting guidelines</a>.\r\n</div>\r\n'),clearLine:o.compile('<div class="o-comment-ui--clear"></div>\r\n'),commentingSettingsLink:o.compile('<div class="o-comment-ui--settings">\r\n    {{^withoutSeparator}}|{{/withoutSeparator}}<div class="o-comment-ui--settings-text">\r\n    <i class="o-comment-ui--settings-icon"></i> {{label}}{{^label}}Commenting settings{{/label}}</div>\r\n</div>\r\n'),environmentDisplay:o.compile('<div class="o-comment-ui--env-display">Comments environment: <strong>{{envName}}</strong></div>\r\n')}},function(e,t,n){"use strict";var o=n(53);e.exports=o},function(e,t,n){"use strict";var o=n(54);o.Template=n(55).Template,o.template=o.Template,e.exports=o},function(e,t,n){"use strict";!function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function n(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function o(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var o=1,i=e.length;i>o;o++)if(t.charAt(n+o)!=e.charAt(o))return!1;return!0}function i(t,n,o,a){var c=[],l=null,u=null,d=null;for(u=o[o.length-1];t.length>0;){if(d=t.shift(),u&&"<"==u.tag&&!(d.tag in E))throw new Error("Illegal content in < super tag.");if(e.tags[d.tag]<=e.tags.$||r(d,a))o.push(d),d.nodes=i(t,d.tag,o,a);else{if("/"==d.tag){if(0===o.length)throw new Error("Closing tag without opener: /"+d.n);if(l=o.pop(),d.n!=l.n&&!s(d.n,l.n,a))throw new Error("Nesting error: "+l.n+" vs. "+d.n);return l.end=d.i,c}"\n"==d.tag&&(d.last=0==t.length||"\n"==t[0].tag)}c.push(d)}if(o.length>0)throw new Error("missing closing tag: "+o.pop().n);return c}function r(e,t){for(var n=0,o=t.length;o>n;n++)if(t[n].o==e.n)return e.tag="#",!0}function s(e,t,n){for(var o=0,i=n.length;i>o;o++)if(n[o].c==e&&n[o].o==t)return!0}function a(e){var t=[];for(var n in e)t.push('"'+l(n)+'": function(c,p,t,i) {'+e[n]+"}");return"{ "+t.join(",")+" }"}function c(e){var t=[];for(var n in e.partials)t.push('"'+l(n)+'":{name:"'+l(e.partials[n].name)+'", '+c(e.partials[n])+"}");return"partials: {"+t.join(",")+"}, subs: "+a(e.subs)}function l(e){return e.replace(y,"\\\\").replace(g,'\\"').replace(h,"\\n").replace(v,"\\r").replace(b,"\\u2028").replace(w,"\\u2029")}function u(e){return~e.indexOf(".")?"d":"f"}function d(e,t){var n="<"+(t.prefix||""),o=n+e.n+C++;return t.partials[o]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+l(o)+'",c,p,"'+(e.indent||"")+'"));',o}function f(e,t){t.code+="t.b(t.t(t."+u(e.n)+'("'+l(e.n)+'",c,p,0)));'}function m(e){return"t.b("+e+");"}var p=/\S/,g=/\"/g,h=/\n/g,v=/\r/g,y=/\\/g,b=/\u2028/,w=/\u2029/;e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(i,r){function s(){y.length>0&&(b.push({tag:"_t",text:new String(y)}),y="")}function a(){for(var t=!0,n=C;n<b.length;n++)if(t=e.tags[b[n].tag]<e.tags._v||"_t"==b[n].tag&&null===b[n].text.match(p),!t)return!1;return t}function c(e,t){if(s(),e&&a())for(var n,o=C;o<b.length;o++)b[o].text&&((n=b[o+1])&&">"==n.tag&&(n.indent=b[o].text.toString()),b.splice(o,1));else t||b.push({tag:"\n"});w=!1,C=b.length}function l(e,t){var o="="+S,i=e.indexOf(o,t),r=n(e.substring(e.indexOf("=",t)+1,i)).split(" ");return k=r[0],S=r[r.length-1],i+o.length-1}var u=i.length,d=0,f=1,m=2,g=d,h=null,v=null,y="",b=[],w=!1,E=0,C=0,k="{{",S="}}";for(r&&(r=r.split(" "),k=r[0],S=r[1]),E=0;u>E;E++)g==d?o(k,i,E)?(--E,s(),g=f):"\n"==i.charAt(E)?c(w):y+=i.charAt(E):g==f?(E+=k.length-1,v=e.tags[i.charAt(E+1)],h=v?i.charAt(E+1):"_v","="==h?(E=l(i,E),g=d):(v&&E++,g=m),w=E):o(S,i,E)?(b.push({tag:h,n:n(y),otag:k,ctag:S,i:"/"==h?w-k.length:E+S.length}),y="",E+=S.length-1,g=d,"{"==h&&("}}"==S?E++:t(b[b.length-1]))):y+=i.charAt(E);return c(w,!0),b};var E={_t:!0,"\n":!0,$:!0,"/":!0};e.stringify=function(t,n,o){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+c(t)+"}"};var C=0;e.generate=function(t,n,o){C=0;var i={code:"",subs:{},partials:{}};return e.walk(t,i),o.asString?this.stringify(i,n,o):this.makeTemplate(i,n,o)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,n){var o=this.makePartials(e);return o.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(o,t,this,n)},e.makePartials=function(e){var t,n={subs:{},partials:e.partials,name:e.name};for(t in n.partials)n.partials[t]=this.makePartials(n.partials[t]);for(t in e.subs)n.subs[t]=new Function("c","p","t","i",e.subs[t]);return n},e.codegen={"#":function(t,n){n.code+="if(t.s(t."+u(t.n)+'("'+l(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,n),n.code+="});c.pop();}"},"^":function(t,n){n.code+="if(!t.s(t."+u(t.n)+'("'+l(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,n),n.code+="};"},">":d,"<":function(t,n){var o={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,o);var i=n.partials[d(t,n)];i.subs=o.subs,i.partials=o.partials},$:function(t,n){var o={subs:{},code:"",partials:n.partials,prefix:t.n};e.walk(t.nodes,o),n.subs[t.n]=o.code,n.inPartial||(n.code+='t.sub("'+l(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=m('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+u(e.n)+'("'+l(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=m('"'+l(e.text)+'"')},"{":f,"&":f},e.walk=function(t,n){for(var o,i=0,r=t.length;r>i;i++)o=e.codegen[t[i].tag],o&&o(t[i],n);return n},e.parse=function(e,t,n){return n=n||{},i(e,"",[],n.sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,n){n=n||{};var o=e.cacheKey(t,n),i=this.cache[o];if(i){var r=i.partials;for(var s in r)delete r[s].instance;return i}return i=this.generate(this.parse(this.scan(t,n.delimiters),t,n),t,n),this.cache[o]=i}}(t)},function(e,t,n){"use strict";!function(e){function t(e,t,n){var o;return t&&"object"==typeof t&&(void 0!==t[e]?o=t[e]:n&&t.get&&"function"==typeof t.get&&(o=t.get(e))),o}function n(e,t,n,o,i,r){function s(){}function a(){}s.prototype=e,a.prototype=e.subs;var c,l=new s;l.subs=new a,l.subsText={},l.buf="",o=o||{},l.stackSubs=o,l.subsText=r;for(c in t)o[c]||(o[c]=t[c]);for(c in o)l.subs[c]=o[c];i=i||{},l.stackPartials=i;for(c in n)i[c]||(i[c]=n[c]);for(c in i)l.partials[c]=i[c];return l}function o(e){return String(null===e||void 0===e?"":e)}function i(e){return e=o(e),u.test(e)?e.replace(r,"&amp;").replace(s,"&lt;").replace(a,"&gt;").replace(c,"&#39;").replace(l,"&quot;"):e}e.Template=function(e,t,n,o){e=e||{},this.r=e.code||this.r,this.c=n,this.options=o||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:i,t:o,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},ep:function(e,t){var o=this.partials[e],i=t[o.name];if(o.instance&&o.base==i)return o.instance;if("string"==typeof i){if(!this.c)throw new Error("No compiler available.");i=this.c.compile(i,this.options)}if(!i)return null;if(this.partials[e].base=i,o.subs){t.stackText||(t.stackText={});for(key in o.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);i=n(i,o.subs,o.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=i,i},rp:function(e,t,n,o){var i=this.ep(e,n);return i?i.ri(t,n,o):""},rs:function(e,t,n){var o=e[e.length-1];if(!d(o))return void n(e,t,this);for(var i=0;i<o.length;i++)e.push(o[i]),n(e,t,this),e.pop()},s:function(e,t,n,o,i,r,s){var a;return d(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,n,o,i,r,s)),a=!!e,!o&&a&&t&&t.push("object"==typeof e?e:t[t.length-1]),a)},d:function(e,n,o,i){var r,s=e.split("."),a=this.f(s[0],n,o,i),c=this.options.modelGet,l=null;if("."===e&&d(n[n.length-2]))a=n[n.length-1];else for(var u=1;u<s.length;u++)r=t(s[u],a,c),void 0!==r?(l=a,a=r):a="";return i&&!a?!1:(i||"function"!=typeof a||(n.push(l),a=this.mv(a,n,o),n.pop()),a)},f:function(e,n,o,i){for(var r=!1,s=null,a=!1,c=this.options.modelGet,l=n.length-1;l>=0;l--)if(s=n[l],r=t(e,s,c),void 0!==r){a=!0;break}return a?(i||"function"!=typeof r||(r=this.mv(r,n,o)),r):i?!1:""},ls:function(e,t,n,i,r){var s=this.options.delimiters;return this.options.delimiters=r,this.b(this.ct(o(e.call(t,i)),t,n)),this.options.delimiters=s,!1},ct:function(e,t,n){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,n)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,n,o,i,r,s){var a,c=t[t.length-1],l=e.call(c);return"function"==typeof l?o?!0:(a=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(l,c,n,a.substring(i,r),s)):l},mv:function(e,t,n){var i=t[t.length-1],r=e.call(i);return"function"==typeof r?this.ct(o(r.call(i)),i,n):r},sub:function(e,t,n,o){var i=this.subs[e];i&&(this.activeSub=e,i(t,n,this,o),this.activeSub=!1)}};var r=/&/g,s=/</g,a=/>/g,c=/\'/g,l=/\"/g,u=/[&<>\"\']/,d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},function(e,t){"use strict";t.toDOM=function(e){var t=document,n=void 0,o=t.createElement("div"),i=t.createDocumentFragment();for(o.innerHTML=e;o.firstChild;)n=o.firstChild,i.appendChild(n);return i},t.getComputedStyle=function(e,t){return window.getComputedStyle?(t="boolean"==typeof t?t:!1,window.getComputedStyle(e,t)):{getPropertyValue:function(t){var n=/(\-([a-zA-Z]){1})/g;return"float"===t&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null}}},t.windowSize=function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0],i=e.innerWidth||o.clientWidth||n.clientWidth,r=e.innerHeight||o.clientHeight||n.clientHeight;return{width:i,height:r}}},function(e,t,n){"use strict";t.showSetPseudonymDialog=n(58).show,t.showSettingsDialog=n(86).show,t.showChangePseudonymDialog=n(87).show,t.showEmailAlertDialog=n(88).show,t.showInactivityMessage=n(89).show},function(e,t,n){"use strict";var o=n(59),i=n(84),r=n(7),s=!1;t.show=function(e){s===!1&&!function(){if("object"!=typeof e||!e)throw new Error("Callbacks not provided.");if("function"!=typeof e.submit)throw new Error("Submit callback not provided.");s=!0;var t=!1,n=!1,a=new i({method:"GET",action:"",name:"setpseudonym",items:[{type:"initialPseudonym"}],buttons:[{type:"submitButton",label:"Save"},{type:"cancelButton"}]}),c=new o("oCommentUi_setPseudonymDialog",{html:a.getContainerDomElement(),heading:{title:"Commenting Settings"},modal:!0}),l=function(o){if(!t){t=!0,a.disableButtons();var i=a.serialize();e.submit(i,function(e){return e?(a.showError(e),a.enableButtons(),void(t=!1)):(s=!1,n=!0,void c.close())})}return o.preventDefault?o.preventDefault():o.returnValue=!1,!1};a.getFormDomElement().addEventListener("submit",l);var u=function f(){s=!1,a&&(a.getFormDomElement().removeEventListener("submit",l),a.getContainerDomElement().removeEventListener("oCommentUi.form.cancel",d),a.destroy(),a=null),c&&(c.wrapper.removeEventListener("oOverlay.destroy",f),c=null),n||("function"==typeof e.close&&e.close(),t||r.logger.log("pseudonym refused"))};c.open();var d=function(){c.close()};a.getContainerDomElement().addEventListener("oCommentUi.form.cancel",d),c.wrapper.addEventListener("oOverlay.destroy",u)}()}},function(e,t,n){e.exports=n(60)},function(e,t,n){"use strict";var o=n(61),i=function r(){o.init(),document.removeEventListener("o.DOMContentLoaded",r)};document.addEventListener("o.DOMContentLoaded",i),e.exports=o},function(e,t,n){"use strict";var o=n(62)["default"],i=n(74),r=n(76),s=n(79),a=n(83),c={},l=function(e){if(!e.trigger||e.trigger instanceof HTMLElement||(e.trigger=document.querySelector(e.trigger)),e.heading&&(!e.heading.title||!e.heading.title.trim()))throw new Error('"o-overlay error": To have a heading, a non-empty title needs to be set');if(e.arrow||"undefined"!=typeof e.modal||(e.modal=!0),e.compact&&e.heading&&e.heading.shaded)throw new Error('"o-overlay error": Compact overlays can\'t have a shaded header');if(e.arrow){if(e.arrow.position||(e.arrow.position="left"),e.modal&&(e.modal=!1),"left"!==e.arrow.position&&"right"!==e.arrow.position&&"top"!==e.arrow.position&&"bottom"!==e.arrow.position)throw new Error('"o-overlay error": The position of the arrow has to be either "top", "bottom", "left" or "right".');if(("top"===e.arrow.position||"bottom"===e.arrow.position)&&e.heading&&e.heading.shaded)throw new Error('"o-overlay error": The position of the arrow can\'t be set to "top" or "bottom" when the shaded heading option is set to true.');if(e.arrow.target)e.arrow.target instanceof HTMLElement||(e.arrow.target=document.querySelector(e.arrow.target));else{if(!e.trigger)throw new Error('"o-overlay error": For overlays with arrows, if you don\'t set a trigger, you do need to set a target for the overlay.');e.arrow.target=e.trigger}}return e},u=function(e){var t={};return e instanceof HTMLElement&&(Array.prototype.forEach.call(e.attributes,function(e){if(0===e.name.indexOf("data-o-overlay")){var n=e.name.replace("data-o-overlay-","");t=a.optionsFromKey(n,e.value,t)}}),t.trigger=e),t},d=function(e,t){
t.stopPropagation();var n=c[e];n&&(n.visible===!0?n.close():n.open())},f=function(e,t){r.listenTo("resize"),this.visible=!1,this.id=e;try{this.opts=l(t)}catch(n){throw this.broadcast("log","oErrors",{error:n}),n}if(!this.opts){var o=new Error('"o-overlay error": Required options have not been set');throw this.broadcast("log","oErrors",{error:o}),o}this.opts.trigger?(this.opts.trigger.addEventListener("click",d.bind(this.opts.trigger,e),!1),this.context=this.opts.arrow?s.getLayerContext(this.opts.arrow.target):s.getLayerContext(this.opts.trigger)):this.context=this.opts.arrow?s.getLayerContext(this.opts.arrow.target):document.body,this.delegates={doc:new i,wrap:new i,context:new i},c[e]=this};f.prototype.open=function(){var e=this;this.opts.trigger&&this.opts.trigger.setAttribute("aria-pressed","true"),this.content?this.show():!function(){var t=e;e.loadContent(function(e){if(t.opts.html=e,!t.opts.html)throw new Error('"o-overlay error": Content for the overlay needs to be set via the "html" or the "src" option.');t.render()})}()},f.prototype.loadContent=function(e){!this.opts.html&&this.opts.src?/^(https?\:\/)?\//.test(this.opts.src)?a.copyContentFromUrl(this.opts.src,function(t){e(t)}):a.copyContentFromElement(document.querySelector(this.opts.src),function(t){e(t)}):e(this.opts.html)},f.prototype.render=function(){var e=document.createElement("div");if(e.className="o-overlay",e.classList.add("o-overlay--"+this.id.replace(" ","-")),e.setAttribute("role","dialog"),this.opts.zindex&&(e.style.zIndex=this.opts.zindex),this.wrapper=e,this.opts.heading){var t=document.createElement("header"),n=this.opts.heading.title.replace(" ","-").toLowerCase();t.classList.add("o-overlay__heading"),t.setAttribute("id",n),e.setAttribute("aria-labelledby",n),this.opts.heading.shaded&&t.classList.add("o-overlay__heading--shaded");var o=document.createElement("a");o.className="o-overlay__close",o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.setAttribute("href","#void"),o.setAttribute("aria-label","Close"),o.setAttribute("title","Close");var i=document.createElement("span");i.setAttribute("role","heading"),i.className="o-overlay__title",i.innerHTML=this.opts.heading.title,t.appendChild(o),t.appendChild(i),e.appendChild(t)}var r=document.createElement("section");r.className="o-overlay__content",e.appendChild(r),this.content=r,this.opts.compact&&e.classList.add("o-overlay--compact"),this.show()},f.prototype.show=function(){if(this.opts.modal){this.wrapper.classList.add("o-overlay--modal");var e=document.createElement("div");e.className="o-overlay-shadow",this.shadow=e,document.body.appendChild(e)}this.delegates.doc.root(document.body),this.delegates.wrap.root(this.wrapper),this.delegates.context.root(this.context),this.closeHandler=this.close.bind(this),this.resizeListenerHandler=this.resizeListener.bind(this),this.delegates.doc.on("oViewport.resize","body",this.resizeListenerHandler),this.closeOnNewLayerHandler=this.closeOnNewLayer.bind(this),this.delegates.context.on("oLayers.new",this.closeOnNewLayerHandler),this.opts.heading&&(this.delegates.wrap.on("click",".o-overlay__close",this.closeHandler),this.delegates.wrap.on("touchend",".o-overlay__close",this.closeHandler)),this.closeOnExternalClickHandler=this.closeOnExternalClick.bind(this),this.delegates.doc.on("click","body",this.closeOnExternalClickHandler),this.delegates.doc.on("touchend","body",this.closeOnExternalClickHandler),this.closeOnEscapePressHandler=this.closeOnEscapePress.bind(this),this.delegates.doc.on("keyup",this.closeOnEscapePressHandler),this.broadcast("new","oLayers"),this.context.appendChild(this.wrapper),this.wrapper.setAttribute("tabindex","0"),this.wrapper.style.outline=0;var t=this;window.requestAnimationFrame(function(){t.content.innerHTML||("string"==typeof t.opts.html?t.content.innerHTML=t.opts.html:t.content.appendChild(t.opts.html)),t.width=t.getWidth(),t.height=t.getHeight(),t.respondToWindow(r.getSize()),t.visible=!0,t.wrapper.focus(),t.broadcast("ready"),t.broadcast("event","oTracking",{category:"overlay",action:"show",overlay_id:t.id})})},f.prototype.close=function(){return this.delegates.doc.destroy(),this.delegates.wrap.destroy(),this.delegates.context.destroy(),r.stopListeningTo("resize"),this.broadcast("destroy"),this.broadcast("event","oTracking",{category:"overlay",action:"close",overlay_id:this.id}),this.context.removeChild(this.wrapper),this.opts.modal&&this.shadow.parentNode.removeChild(this.shadow),this.opts.trigger&&(this.opts.trigger.focus(),this.opts.trigger.setAttribute("aria-pressed","false")),this.visible=!1,this.broadcast("close","oLayers"),!1},f.prototype.closeOnExternalClick=function(e){this.wrapper.contains(e.target)||this.opts.modal||!this.opts.trigger||this.opts.trigger.contains(e.target)||this.close()},f.prototype.closeOnEscapePress=function(e){27===e.keyCode&&this.close()},f.prototype.closeOnNewLayer=function(e){e.detail&&e.detail.el===this||this.close()},f.prototype.resizeListener=function(e){this.wrapper.contains(e.target)||this.respondToWindow(e.detail.viewport)},f.prototype.broadcast=function(e,t,n){t=t||"oOverlay";var o="oLayers"===t?this.context:this.wrapper||document.body;n=n||{},"oTracking"!==t&&(n.el=this),o.dispatchEvent(new CustomEvent(t+"."+e,{detail:n,bubbles:"oLayers"!==t}))},f.prototype.realign=function(e,t){var n="width"===e?"left":"top";if(t<=this[e]){if(this.wrapper.classList.add("o-overlay--full-"+e),this.wrapper.style[n]="0",this.wrapper.style["margin"+a.capitalise(n)]=0,"height"===e){var o=this.wrapper.offsetHeight-this.wrapper.clientHeight;this.content.style.height=this.wrapper.offsetHeight-(this.opts.heading?this.wrapper.querySelector("header").offsetHeight:0)-o+"px"}}else"height"===e&&(this.content.style.height=null),this.wrapper.classList.remove("o-overlay--full-"+e),this.opts.arrow||(this.wrapper.style["margin"+a.capitalise(n)]=-(this.wrapper["offset"+a.capitalise(e)]/2)+"px"),this.wrapper.style[n]="50%"},f.prototype.respondToWindow=function(e){if(this.realign("width",e.width),this.realign("height",e.height),this.wrapper.classList.remove("o-overlay__arrow-top"),this.wrapper.classList.remove("o-overlay__arrow-bottom"),this.wrapper.classList.remove("o-overlay__arrow-left"),this.wrapper.classList.remove("o-overlay__arrow-right"),this.opts.arrow&&!this.fills()){this.opts.arrow.currentposition=this.getCurrentArrowPosition(this.opts.arrow.position),this.wrapper.classList.add("o-overlay__arrow-"+this.opts.arrow.currentposition);var t="left"===this.opts.arrow.currentposition||"right"===this.opts.arrow.currentposition?"left":"top",n="left"===this.opts.arrow.currentposition||"right"===this.opts.arrow.currentposition?"top":"left",o="left"===this.opts.arrow.currentposition||"right"===this.opts.arrow.currentposition?"height":"width",i=0,r=13,s=a.getOffsetRect(this.opts.arrow.target),c=s[o];switch(this.opts.arrow.currentposition){case"left":i=s.left+s.width+r;break;case"right":i=s.left-this.width-r;break;case"top":i=s.top+s.height+r;break;case"bottom":i=s.top-this.height-r}this.wrapper.style[t]=i+"px",this.wrapper.style[n]=s[n]+c/2-this[o]/2+"px"}},f.prototype.getCurrentArrowPosition=function(e){var t=this.opts.arrow.target.getBoundingClientRect(),n=13,o=this.wrapper.getBoundingClientRect().width+n,i=this.wrapper.getBoundingClientRect().height+n;switch(this.opts.arrow.position){case"left":t.right+o>=window.innerWidth&&t.left-o>0&&(e="right");break;case"right":t.left-o<=0&&t.right+o<window.innerWidth&&(e="left");break;case"top":t.bottom+i>=window.innerHeight&&t.top-i+n>0&&(e="bottom");break;case"bottom":t.top-i<=0&&t.bottom+i<window.innerHeight&&(e="top")}return e},f.prototype.fills=function(e){return this.wrapper.classList.contains("o-overlay--full-"+e)},f.prototype.destroy=function(){this.visible===!0&&this.close(),this.opts.trigger&&this.opts.trigger.removeEventListener("click",d),delete c[this.id]},f.prototype.getHeight=function(){var e=this.wrapper.offsetHeight-this.wrapper.clientHeight;return this.content.scrollHeight+(this.opts.heading?this.wrapper.querySelector("header").offsetHeight:0)+e},f.prototype.getWidth=function(){var e=this.wrapper.offsetWidth-this.wrapper.clientWidth;return this.content.scrollWidth+e},f.init=function(e){e||(e=document.body),e instanceof HTMLElement||(e=document.querySelector(e));for(var t=e.querySelectorAll(".o-overlay-trigger"),n=[],o=0;o<t.length;o++)c[t[o].getAttribute("data-o-overlay-id")]||n.push(new f(t[o].getAttribute("data-o-overlay-id"),u(t[o])));return n},f.destroy=function(){var e=o(c);e.forEach(function(e){c[e].destroy()})},f.getOverlays=function(){return c},e.exports=f},function(e,t,n){e.exports={"default":n(63),__esModule:!0}},function(e,t,n){n(64),e.exports=n(70).Object.keys},function(e,t,n){var o=n(65);n(67)("keys",function(e){return function(t){return e(o(t))}})},function(e,t,n){var o=n(66);e.exports=function(e){return Object(o(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var o=n(68),i=n(70),r=n(73);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),o(o.S+o.F*r(function(){n(1)}),"Object",s)}},function(e,t,n){var o=n(69),i=n(70),r=n(71),s="prototype",a=function(e,t,n){var c,l,u,d=e&a.F,f=e&a.G,m=e&a.S,p=e&a.P,g=e&a.B,h=e&a.W,v=f?i:i[t]||(i[t]={}),y=f?o:m?o[t]:(o[t]||{})[s];f&&(n=t);for(c in n)l=!d&&y&&c in y,l&&c in v||(u=l?y[c]:n[c],v[c]=f&&"function"!=typeof y[c]?n[c]:g&&l?r(u,o):h&&y[c]==u?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[s]=e[s],t}(u):p&&"function"==typeof u?r(Function.call,u):u,p&&((v[s]||(v[s]={}))[c]=u))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,e.exports=a},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){var o=n(72);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,i){return e.call(t,n,o,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){e.exports=n(75)},function(e,t){"use strict";function n(e){this.listenerMap=[{},{}],e&&this.root(e),this.handle=n.prototype.handle.bind(this)}function o(e,t){return e.toLowerCase()===t.tagName.toLowerCase()}function i(e,t){return this.rootElement===window?t===document:this.rootElement===t}function r(e,t){return e===t.id}e.exports=n,n.prototype.root=function(e){var t,n=this.listenerMap;if(this.rootElement){for(t in n[1])n[1].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!0);for(t in n[0])n[0].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!1)}if(!e||!e.addEventListener)return this.rootElement&&delete this.rootElement,this;this.rootElement=e;for(t in n[1])n[1].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!0);for(t in n[0])n[0].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!1);return this},n.prototype.captureForType=function(e){return-1!==["blur","error","focus","load","resize","scroll"].indexOf(e)},n.prototype.on=function(e,t,n,a){var c,l,u,d;if(!e)throw new TypeError("Invalid event type: "+e);if("function"==typeof t&&(a=n,n=t,t=null),void 0===a&&(a=this.captureForType(e)),"function"!=typeof n)throw new TypeError("Handler must be a type of Function");return c=this.rootElement,l=this.listenerMap[a?1:0],l[e]||(c&&c.addEventListener(e,this.handle,a),l[e]=[]),t?/^[a-z]+$/i.test(t)?(d=t,u=o):/^#[a-z0-9\-_]+$/i.test(t)?(d=t.slice(1),u=r):(d=t,u=s):(d=null,u=i.bind(this)),l[e].push({selector:t,handler:n,matcher:u,matcherParam:d}),this},n.prototype.off=function(e,t,n,o){var i,r,s,a,c;if("function"==typeof t&&(o=n,n=t,t=null),void 0===o)return this.off(e,t,n,!0),this.off(e,t,n,!1),this;if(s=this.listenerMap[o?1:0],!e){for(c in s)s.hasOwnProperty(c)&&this.off(c,t,n);return this}if(a=s[e],!a||!a.length)return this;for(i=a.length-1;i>=0;i--)r=a[i],t&&t!==r.selector||n&&n!==r.handler||a.splice(i,1);return a.length||(delete s[e],this.rootElement&&this.rootElement.removeEventListener(e,this.handle,o)),this},n.prototype.handle=function(e){var t,n,o,i,r,s,a,c=e.type,l=[],u="ftLabsDelegateIgnore";if(e[u]!==!0){switch(a=e.target,3===a.nodeType&&(a=a.parentNode),o=this.rootElement,i=e.eventPhase||(e.target!==e.currentTarget?3:2)){case 1:l=this.listenerMap[1][c];break;case 2:this.listenerMap[0]&&this.listenerMap[0][c]&&(l=l.concat(this.listenerMap[0][c])),this.listenerMap[1]&&this.listenerMap[1][c]&&(l=l.concat(this.listenerMap[1][c]));break;case 3:l=this.listenerMap[0][c]}for(n=l.length;a&&n;){for(t=0;n>t&&(r=l[t],r);t++)if(r.matcher.call(a,r.matcherParam,a)&&(s=this.fire(e,a,r)),s===!1)return e[u]=!0,void e.preventDefault();if(a===o)break;n=l.length,a=a.parentElement}}},n.prototype.fire=function(e,t,n){return n.handler.call(t,e,t)};var s=function(e){if(e){var t=e.prototype;return t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector}}(Element);n.prototype.destroy=function(){this.off(),this.root()}},function(e,t,n){e.exports=n(77)},function(e,t,n){"use strict";function o(e,t){"number"==typeof arguments[0]?(o("scroll",arguments[0]),o("resize",arguments[1]),o("orientation",arguments[2]),o("visibility",arguments[3])):t&&(g[e]=t)}function i(){if(!p.resize){var e="resize",t=m(function(e){d.broadcast("resize",{viewport:d.getSize(),originalEvent:e})},g.resize);window.addEventListener(e,t),p.resize={eventType:e,handler:t}}}function r(){if(!p.orientation){var e="orientationchange",t=m(function(e){d.broadcast("orientation",{viewport:d.getSize(),orientation:d.getOrientation(),originalEvent:e})},g.orientation);window.addEventListener(e,t),p.orientation={eventType:e,handler:t}}}function s(){if(!p.visibility){var e=d.detectVisiblityAPI().eventType,t=m(function(e){d.broadcast("visibility",{hidden:d.getVisibility(),originalEvent:e})},g.visibility);window.addEventListener(e,t),p.visibility={eventType:e,handler:t}}}function a(){if(!p.scroll){var e="scroll",t=f(function(e){var t=d.getScrollPosition();d.broadcast("scroll",{viewport:d.getSize(),scrollHeight:t.height,scrollLeft:t.left,scrollTop:t.top,scrollWidth:t.width,originalEvent:e})},g.scroll);window.addEventListener(e,t),p.scroll={eventType:e,handler:t}}}function c(e){"resize"!==e&&"all"!==e||i(),"scroll"!==e&&"all"!==e||a(),"orientation"!==e&&"all"!==e||r(),"visibility"!==e&&"all"!==e||s()}function l(e){"all"===e?u(p).forEach(l):p[e]&&(window.removeEventListener(p[e].eventType,p[e].handler),delete p[e])}var u=n(62)["default"],d=n(78),f=d.throttle,m=d.debounce,p={},g={resize:100,orientation:100,visibility:100,scroll:100};e.exports={debug:function(){d.debug()},listenTo:c,stopListeningTo:l,setThrottleInterval:o,getOrientation:d.getOrientation,getSize:d.getSize,getScrollPosition:d.getScrollPosition}},function(e,t){"use strict";function n(e,t,n){n=n||document.body,f&&console.log("o-viewport",e,t),n.dispatchEvent(new CustomEvent("oViewport."+e,{detail:t,bubbles:!0}))}function o(e){return e?document.documentElement.clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}function i(e){return e?document.documentElement.clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0)}function r(t){return{height:e.exports.getHeight(t),width:e.exports.getWidth(t)}}function s(){var e=document.documentElement,t=document.body,n="CSS1Compat"===(document.compatMode||""),o=n?e.scrollLeft:t.scrollLeft,i=n?e.scrollTop:t.scrollTop;return{height:t.scrollHeight,width:t.scrollWidth,left:window.pageXOffset||window.scrollX||o,top:window.pageYOffset||window.scrollY||i}}function a(){var e=window.screen.orientation||window.screen.mozOrientation||window.screen.msOrientation||void 0;return e?"string"==typeof e?e.split("-")[0]:e.type.split("-")[0]:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?"portrait":"landscape":o()>=i()?"portrait":"landscape"}function c(){var e=void 0,t=void 0;return"undefined"!=typeof document.hidden?(e="hidden",t="visibilitychange"):"undefined"!=typeof document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hiddenName:e,eventType:t}}function l(){var e=c().hiddenName;return document[e]}function u(e,t){var n=void 0;return function(){var o=this,i=arguments,r=function(){n=null,e.apply(o,i)};clearTimeout(n),n=setTimeout(r,t)}}function d(e,t){var n=void 0;return function(){var o=this;if(!n){var i=arguments,r=function(){n=null,e.apply(o,i)};n=setTimeout(r,t)}}}var f=void 0;e.exports={debug:function(){f=!0},broadcast:n,getWidth:i,getHeight:o,getSize:r,getScrollPosition:s,getVisibility:l,getOrientation:a,detectVisiblityAPI:c,throttle:d,debounce:u}},function(e,t,n){e.exports=n(80)},function(e,t,n){"use strict";var o=n(81);e.exports={getLayerContext:function(e){return o.getClosestMatch(e,".o-layers__context")||document.body}}},function(e,t,n){e.exports=n(82)},function(e,t){"use strict";function n(e,t){for(;e;){if(e.matches(t))return e;e=e.parentElement}return!1}function o(e){var t=0;if(e&&"object"==typeof e&&1===e.nodeType){for(;e.previousSibling;)e=e.previousSibling,1===e.nodeType&&++t;return t}}t.getClosestMatch=n,t.getIndex=o},function(e,t){"use strict";e.exports={unCapitalise:function(e){return e.charAt(0).toLowerCase()+e.substr(1)},capitalise:function(e){return e.charAt(0).toUpperCase()+e.substr(1)},copyContentFromElement:function(e,t){var n="SCRIPT"===e.nodeName?e.innerHTML:e.outerHTML;t(n)},copyContentFromUrl:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){4===n.readyState&&t(200===n.status?n.responseText:"Content failed to load correctly")},n.onerror=function(t){throw new Error('"o-overlay error": Fetching content from '+e+" failed with errror "+t)},n.send(null)},optionsFromKey:function(e,t,n){var o=e.indexOf("-");if(-1===o)try{n[e]=JSON.parse(t.replace(/\'/g,'"'))}catch(i){n[e]=t}else{var r=e.substr(0,o);n[r]||(n[r]={}),n[r]=this.optionsFromKey(e.substr(o+1),t,n[r])}return n},getOffsetRect:function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,i=window.pageYOffset||o.scrollTop||n.scrollTop,r=window.pageXOffset||o.scrollLeft||n.scrollLeft,s=o.clientTop||n.clientTop||0,a=o.clientLeft||n.clientLeft||0;return{width:t.width||t.right-t.left,height:t.height||t.bottom-t.top,top:t.top+i-s,left:t.left+r-a}}}},function(e,t,n){"use strict";function o(e){function t(){var t=void 0,r=void 0,p=void 0;if(i=document.createElement("div"),i.className="o-comment-ui--overlay-content",o=document.createElement("form"),o.setAttribute("name",e.name||""),o.setAttribute("method",e.method||""),o.setAttribute("action",e.action||""),i.appendChild(o),o.appendChild(s.toDOM(c.render())),e.items&&e.items.length)for(p=0;p<e.items.length;p++)t=e.items[p],"object"==typeof t&&"function"==typeof a[t.type]?o.appendChild(s.toDOM(a[t.type].call(n,t))):"string"==typeof t&&o.appendChild(s.toDOM(t));if(e.buttons&&e.buttons.length){o.appendChild(s.toDOM(l.render()));var g=o.querySelector(".o-comment-ui--overlay-button-container");for(p=0;p<e.buttons.length;p++)switch(r=e.buttons[p],r.type){case"button":"undefined"!=typeof r.label&&r.label&&g.appendChild(s.toDOM(u.render({type:"button",label:r.label})));break;case"submitButton":g.appendChild(s.toDOM(u.render({type:"submit",label:r.label?r.label:"Submit"})));break;case"cancelButton":g.appendChild(s.toDOM(d.render({label:r.label?r.label:"cancel"})));break;case"dismiss":"undefined"!=typeof r.label&&r.label&&g.appendChild(s.toDOM(f.render({label:r.label})))}o.appendChild(s.toDOM(m.render()));for(var h=o.querySelectorAll(".o-comment-ui--cancel-button"),v=function(){i.dispatchEvent(new CustomEvent("oCommentUi.form.cancel",{bubbles:!0}))},y=0;y<h.length;y++)h[y].addEventListener("click",v)}}if(!e||"object"!=typeof e)throw"Configuration missing or invalid.";var n=this,o=void 0,i=void 0;t.call(this),this.getContainerDomElement=function(){return i},this.getDomElement=this.getContainerDomElement,this.getFormDomElement=function(){return o},this.serialize=function(){return p(o)},this.showError=function(e){var t=o.querySelector(".o-comment-ui--overlay-error-message");t&&(t.innerHTML=e)},this.clearError=function(){var e=o.querySelector(".o-comment-ui--overlay-error-message");e&&(e.innerHTML="")};var r=function(e){for(var t=0;t<e.length;t++)e[t].setAttribute("disabled","disabled")};this.disableButtons=function(){var e=o.querySelectorAll("button"),t=o.querySelectorAll("input[type=button]"),n=o.querySelectorAll("input[type=submit]");r(e),r(t),r(n)};var g=function(e){for(var t=0;t<e.length;t++)e[t].removeAttribute("disabled")};this.enableButtons=function(){var e=o.querySelectorAll("button"),t=o.querySelectorAll("input[type=button]"),n=o.querySelectorAll("input[type=submit]");g(e),g(t),g(n)},this.destroy=function(){o=null,n=null}}var i=n(52),r=n(51),s=n(56),a=n(85),c=i.compile('<div class="o-comment-ui--overlay-error-message"></div>\r\n'),l=i.compile('<div class="o-comment-ui--overlay-button-container"></div>\r\n'),u=i.compile('<button type="{{type}}" class="o-comment-ui--button">\r\n    {{label}}\r\n</button>\r\n'),d=i.compile('<span class="o-comment-ui--overlay-cancel">\r\n    or <button class="o-comment-ui--cancel-button" type="button">\r\n        {{label}}\r\n    </button>\r\n</span>\r\n'),f=i.compile('<span class="o-comment-ui--dismiss">\r\n    <label for="o-comment-ui--dismiss">\r\n        {{label}}\r\n    </label>\r\n    <input name="dismiss" id="dismiss" type="checkbox" />\r\n</span>\r\n'),m=r.clearLine,p=function(e){var t=void 0,n={},o=void 0,i=void 0;if("object"==typeof e&&"FORM"===e.nodeName)for(o=e.elements.length-1;o>=0;o--)if(t=e.elements[o],t.name&&"file"!==t.type&&"reset"!==t.type&&!t.hasAttribute("disabled"))if("select-multiple"===t.type)for(i=e.elements[o].options.length-1;i>=0;i--)t.options[i].selected&&(n[t.name]=t.options[i].value);else"submit"!==t.type&&"button"!==t.type&&("checkbox"!==t.type&&"radio"!==t.type||t.checked)&&(n[t.name]=t.value);return n};e.exports=o},function(e,t,n){"use strict";var o=n(52),i=o.compile('<fieldset>\r\n    <legend>{{legend}}</legend>\r\n    {{{content}}}\r\n</fieldset>\r\n<div class="o-comment-ui--clear"></div>\r\n'),r=o.compile('<label for="{{name}}">{{label}}</label>\r\n<input type="text" name="{{name}}" id="{{name}}" class="input-text" value="{{currentPseudonym}}" />\r\n'),s=o.compile('{{#selects}}\r\n    <label for="{{name}}" class="label-inline" style="width: 75%;">{{label}}</label>\r\n    <select name="{{name}}" id="{{name}}" class="input-inline" style="width: 24%;">\r\n        {{#options}}\r\n            <option value="{{val}}" {{#selected}}selected="selected"{{/selected}}>{{label}}</option>\r\n        {{/options}}\r\n    </select>\r\n    <div class="clear"></div>\r\n{{/selects}}\r\n\r\n<br/>\r\n\r\n{{#checkboxes}}\r\n    <label for="{{name}}" class="label-inline" style="width: 75%">{{label}}</label>\r\n    <input type="checkbox" class="checkbox" name="{{name}}" id="{{name}}" {{#checked}}checked="checked"{{/checked}}>\r\n{{/checkboxes}}\r\n'),a=o.compile('<div class="o-comment-ui--overlay-explanation">\r\n    <div class="o-comment-ui--overlay-explanation-text-container">\r\n        <div class="o-comment-ui--overlay-explanation-text-bg">\r\n            <div class="o-comment-ui--overlay-explanation-text">\r\n                {{text}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="o-comment-ui--overlay-explanation-image-wrapper">\r\n        <div class="o-comment-ui--overlay-explanation-image-container">\r\n            <div class="o-comment-ui--overlay-explanation-image-inner-container">\r\n                <span class="o-comment-ui--overlay-explanation-image o-comment-ui--overlay-explanation-{{type}}">&nbsp;</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="o-comment-ui--clear"></div>\r\n'),c=o.compile('Sorry, due to inactivity you have been signed out.\r\nTo continue please\r\n<a href="https://accounts.ft.com/login?location={{location}}">sign in</a>\r\nagain.\r\n');t.initialPseudonym=function(){return i.render({legend:"Pseudonym",content:r.render({name:"pseudonym",label:"In order to use the commenting system, please choose a pseudonym.",currentPseudonym:""})})},t.changePseudonym=function(e){return i.render({legend:"Pseudonym",content:r.render({name:"pseudonym",label:"This is displayed with your comments. If you change it, previous comments will also be attributed to the new pseudonym.",currentPseudonym:e.currentPseudonym||""})})};var l=function(e){return e&&"object"==typeof e||(e={}),e.emailcomments=e.emailcomments||"hourly",e.emailreplies=e.emailreplies||"immediately",e.emaillikes=e.emaillikes||"never",s.render({selects:[{name:"emailreplies",label:"Someone replies to my comments:",options:[{val:"never",label:"Never",selected:"never"===e.emailreplies},{val:"immediately",label:"Immediately",selected:"immediately"===e.emailreplies},{val:"hourly",label:"Hourly",selected:"hourly"===e.emailreplies}]},{name:"emaillikes",label:"Someone recommends my comments:",options:[{val:"never",label:"Never",selected:"never"===e.emaillikes},{val:"immediately",label:"Immediately",selected:"immediately"===e.emaillikes},{val:"hourly",label:"Hourly",selected:"hourly"===e.emaillikes}]},{name:"emailcomments",label:"Someone comments in a conversation I'm following:",options:[{val:"never",label:"Never",selected:"never"===e.emailcomments},{val:"immediately",label:"Immediately",selected:"immediately"===e.emailcomments},{val:"hourly",label:"Hourly",selected:"hourly"===e.emailcomments}]}],checkboxes:[{name:"emailautofollow",label:"Check to automatically follow a conversation you comment on:",checked:"on"===e.emailautofollow}]})};t.emailSettings=function(e){return i.render({legend:"Email Settings",content:"Receive alerts when:<br/>"+l(e.currentSettings)})},t.emailSettingsStandalone=function(e){return i.render({legend:"Email Settings",content:l(e.currentSettings)})},t.followExplanation=function(){return a.render({text:"To receive email alerts about conversations that you're interested in, click the 'follow' button that now appears on the comment box.",type:"follow"})},t.commentingSettingsExplanation=function(){return a.render({text:"You can manage your settings in the Commenting settings panel above the comment box.",type:"settings"})},t.sessionExpired=function(){return c.render({location:encodeURIComponent(document.location.href)})}},function(e,t,n){"use strict";var o=n(59),i=n(84),r=!1;t.show=function(e,t){r===!1&&!function(){if("object"!=typeof t||!t)throw new Error("Callbacks not provided.");if("function"!=typeof t.submit)throw new Error("Submit callback not provided.");r=!0;var n=!1,s=e&&"object"==typeof e&&e.settings?e.settings:{},a=e&&"object"==typeof e&&e.displayName?e.displayName:"",c=new i({method:"GET",action:"",name:"changepseudonym",items:[{type:"changePseudonym",currentPseudonym:a},{type:"emailSettings",currentSettings:s}],buttons:[{type:"submitButton",label:"Save"},{type:"cancelButton"}]}),l=new o("oCommentUi_settingsDialog",{html:c.getContainerDomElement(),heading:{title:"Commenting Settings"},modal:!0}),u=!1,d=function(e){if(!n){n=!0,c.disableButtons();var o=c.serialize();"on"!==o.emailautofollow&&(o.emailautofollow="off"),t.submit(o,function(e){return e?(c.showError(e),c.enableButtons(),void(n=!1)):(r=!1,u=!0,void l.close())})}return e.preventDefault?e.preventDefault():e.returnValue=!1,!1};c.getFormDomElement().addEventListener("submit",d);var f=function p(){r=!1,c&&(c.getFormDomElement().removeEventListener("submit",d),c.getContainerDomElement().removeEventListener("oCommentUi.form.cancel",m),c.destroy(),c=null),l&&(l.wrapper.removeEventListener("oOverlay.destroy",p),l=null),u||"function"==typeof t.close&&t.close()};l.open();var m=function(){l.close()};c.getContainerDomElement().addEventListener("oCommentUi.form.cancel",m),l.wrapper.addEventListener("oOverlay.destroy",f)}()}},function(e,t,n){"use strict";var o=n(84),i=n(59),r=!1;t.show=function(e,t){if(r===!1){var n=function(){if("object"!=typeof t||!t)throw new Error("Callbacks not provided.");if("function"!=typeof t.submit)throw new Error("Submit callback not provided.");if(!e)return{v:void 0};r=!0;var n=!1;e=e||"";var s=new o({method:"GET",action:"",name:"changepseudonym",items:[{type:"changePseudonym",currentPseudonym:e}],buttons:[{type:"submitButton",label:"Save"},{type:"cancelButton"}]}),a=new i("oCommentUi_changePseudonymDialog",{html:s.getContainerDomElement(),heading:{title:"Commenting Settings"},modal:!0}),c=!1,l=function(e){if(!n){n=!0,s.disableButtons();var o=s.serialize();t.submit(o,function(e){return e?(s.showError(e),s.enableButtons(),void(n=!1)):(r=!1,c=!0,void a.close())})}return e.preventDefault?e.preventDefault():e.returnValue=!1,!1};s.getFormDomElement().addEventListener("submit",l);var u=function f(){r=!1,s&&(s.getFormDomElement().removeEventListener("submit",l),s.getContainerDomElement().removeEventListener("oCommentUi.form.cancel",d),s.destroy(),s=null),a&&(a.wrapper.removeEventListener("oOverlay.destroy",f),a=null),c||"function"==typeof t.close&&t.close()};a.open();var d=function(){a.close()};s.getDomElement().addEventListener("oCommentUi.form.cancel",d),a.wrapper.addEventListener("oOverlay.destroy",u)}();if("object"==typeof n)return n.v}}},function(e,t,n){"use strict";var o=n(59),i=n(84),r=!1;t.show=function(e){r===!1&&!function(){if("object"!=typeof e||!e)throw new Error("Callbacks not provided.");if("function"!=typeof e.submit)throw new Error("Submit callback not provided.");r=!0;var t=!1,n=!1,s=new i({method:"GET",action:"",name:"changepseudonym",items:["<strong>Your comment has been submitted.</strong>",{type:"followExplanation"},{type:"emailSettingsStandalone"},{type:"commentingSettingsExplanation"}],buttons:[{type:"dismiss",label:"Don't show me this message again:"},{type:"submitButton",label:"Save"}]}),a=new o("oCommentUi_emailAlertDialog",{html:s.getContainerDomElement(),heading:{title:"Commenting Settings"},modal:!0}),c=function(o){if(!t){t=!0;var i=s.serialize();"on"!==i.emailautofollow&&(i.emailautofollow="off"),delete i.dismiss,s.disableButtons(),e.submit(i,function(e){return e?(s.showError(e),t=!1,void s.enableButtons()):(n=!0,void a.close())})}return o.preventDefault?o.preventDefault():o.returnValue=!1,!1};s.getDomElement().addEventListener("submit",c);var l=function d(){r=!1,s&&(s.getFormDomElement().removeEventListener("submit",c),s.getContainerDomElement().removeEventListener("oCommentUi.form.cancel",u),s.destroy(),s=null),a&&(a.wrapper.removeEventListener("oOverlay.destroy",d),a=null),n||"function"==typeof e.close&&e.close()};a.open();var u=function(){a.close()};s.getDomElement().addEventListener("oCommentUi.form.cancel",u),a.wrapper.addEventListener("oOverlay.destroy",l)}()}},function(e,t,n){"use strict";var o=n(59),i=n(84),r=!1;t.show=function(e){r===!1&&!function(){if("object"!=typeof e||!e)throw new Error("Callbacks not provided.");if("function"!=typeof e.submit)throw new Error("Submit callback not provided.");r=!0;var t=new i({method:"GET",action:"",name:"sessionexpired",items:[{type:"sessionExpired"}],buttons:[{type:"submitButton",label:"Sign in"},{type:"cancelButton"}]}),n=new o("oCommentUi_inactivityMessageDialog",{html:t.getContainerDomElement(),heading:{title:"Session expired"},modal:!0}),s=function(t){return e.submit(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1};t.getDomElement().addEventListener("submit",s);var a=function l(){r=!1,t&&(t.getFormDomElement().removeEventListener("submit",s),t.getContainerDomElement().removeEventListener("oCommentUi.form.cancel",c),
t.destroy(),t=null),n&&(n.wrapper.removeEventListener("oOverlay.destroy",l),n=null),"function"==typeof e.close&&e.close()};n.open();var c=function(){n.close()};t.getDomElement().addEventListener("oCommentUi.form.cancel",c),n.wrapper.addEventListener("oOverlay.destroy",a)}()}},function(e,t,n){"use strict";var o=n(7);t.emptyLivefyreActionQueue=function(){"undefined"!=typeof Storage&&o.storageWrapper.localStorage.removeItem("fyre-action-queue")},t.isLivefyreActionQueuePresent=function(){return!("undefined"==typeof Storage||!localStorage.getItem("fyre-action-queue"))},t.isPermalinkPresent=function(){return!document.location.hash||-1===document.location.hash.indexOf("lf-content")&&-1===document.location.hash.indexOf("lf_comment")?!(!document.location.search||-1===document.location.search.indexOf("hubRefSrc=permalink")):!0},t.cloneObject=function(e){return JSON.parse(JSON.stringify(e))}},function(e,t,n){"use strict";var o=n(7),i=n(6),r=n(5);t.loadLivefyreCore=function(){var e={loaded:!1,status:"",inProgress:!1,event:new o.Events};return function(t){"function"!=typeof t&&(t=function(){}),e.loaded===!0?"success"===e.status?t():t(e.error):(e.event.on("done",function(){"success"===e.status?t():t(e.error)}),e.inProgress||(e.inProgress=!0,o.scriptLoader({url:i.get().livefyre.resourceDomainBase+i.get().resourceUrls.livefyreJs,cache:!0},function(t){return t?(e.loaded=!0,e.status="error",e.error=t,e.event.trigger("done"),void r.trigger("error.livefyreJs",e.error)):"undefined"==typeof Livefyre?(e.loaded=!0,e.status="error",e.error=new Error("Livefyre core JS Script not loaded."),e.event.trigger("done"),void r.trigger("error.livefyreJs",e.error)):(e.loaded=!0,e.status="success",void e.event.trigger("done"))})))}}()},function(e,t,n){"use strict";function o(e,t){function n(e,t,i,r){var s=o.widgetContainer.querySelector('.fyre-comment-article[data-message-id="'+e+'"]');s&&(t?s.querySelector(".fyre-comment-date"):!0)?r(s):1e3>i?setTimeout(function(){n(e,t,2*i,r)},i):r()}s.WidgetUi.apply(this,arguments),this.config||(this.config=t),"object"!=typeof this.config&&(this.config={}),this.config.layout||(this.config.layout="normal"),this.config.stream_type||(this.config.stream_type="livecomments");var o=this;this.makeReadOnly=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css";var n="#"+o.widgetContainer.id+" .fyre-editor, #"+o.widgetContainer.id+" .fyre-comment-like, #"+o.widgetContainer.id+" .fyre-comment-action-button {display: none;}";t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),e.appendChild(t)},this.hideFollowButton=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css";var n="#"+o.widgetContainer.id+" .fyre-follow-button {display: none;}";t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),e.appendChild(t)},this.hideSignInLink=function(){var e=o.widgetContainer.querySelector("a.fyre-user-loggedout");e&&(e.style.display="none")},this.addAuthNotAvailableMessage=function(){var e=o.widgetContainer.querySelector(".fyre-auth");e&&e.appendChild(s.utils.toDOM(s.templates.authUnavailableTemplate.render()))},this.addTermsAndGuidelineMessage=function(){var e=o.widgetContainer.querySelectorAll(".fyre-widget > .fyre-editor");if(e.length)for(var t=0;t<e.length;t++)e[t].parentNode.insertBefore(s.utils.toDOM(s.templates.termsAndGuidelinesTemplate.render()),e[t].nextSibling)},this.addSettingsLink=function(e){r.logger.log("Commenting settings link adding triggered.");var t=0;clearInterval(i),i=setInterval(function(){var n=o.widgetContainer.querySelector(".fyre-auth .fyre-login-bar .fyre-box-wrapper .fyre-user-loggedin");if(n||120===t){if(clearInterval(i),!o.widgetContainer.querySelector(".o-comment-ui--settings")){if(120===t)return;var r=o.widgetContainer.querySelector(".fyre-auth .fyre-login-bar");if(r){var c={};a.get().emailNotifications!==!0&&(c.label="Edit pseudonym"),r.appendChild(s.utils.toDOM(s.templates.commentingSettingsLink.render(c)))}var l=o.widgetContainer.querySelector(".fyre-auth .fyre-login-bar .o-comment-ui--settings-text");l&&(l.addEventListener("click",function(){e&&"function"==typeof e.onClick&&e.onClick()}),e&&"function"==typeof e.onAdded&&e.onAdded())}}else t++},500)};var i=void 0;this.removeSettingsLink=function(){var e=o.widgetContainer.querySelector(".o-comment-ui--settings");e&&e.parentNode.removeChild(e)},this.moveCommentCountOut=function(){var e=o.widgetContainer.querySelector(".fyre"),t=o.widgetContainer.querySelector(".fyre-stream-stats");if(e&&t){var n=t.querySelector(".fyre-comment-count");n&&(e.style.paddingTop="30px",e.style.position="relative",t.style.position="absolute",t.style.top="0",t.style["float"]="none",t.style.width="100%",t.className="comment-header",n.className="")}},this.showCommentBanned=function(e){n(e,!0,50,function(e){if(e&&!e.querySelector(".o-comments--blocked")){var t=document.createElement("div");if(t.innerHTML="blocked",t.className="o-comments--blocked","side"===o.config.layout){var n=e.querySelector(".fyre-comment-head");n.insertBefore(t,n.firstChild)}else e.querySelector(".fyre-comment-date").style.display="none",e.appendChild(t)}})},this.removeCommentBanned=function(e){n(e,!1,50,function(e){e&&e.querySelector(".o-comments--blocked")&&(e.removeChild(e.querySelector(".o-comments--blocked")),e.querySelector(".fyre-comment-date")&&(e.querySelector(".fyre-comment-date").style.display=""))})};var c=this.destroy;this.destroy=function(){clearInterval(i),c(),c=null}}var i=n(41)["default"],r=n(7),s=n(46),a=n(6);o.__extend=function(e){if("function"==typeof i)e.prototype=i(o.prototype);else{var t=function(){};t.prototype=o.prototype,e.prototype=new t,e.prototype.constructor=e}},s.WidgetUi.__extend(o),e.exports=o},function(e,t){"use strict";t.lfStringOverride={featuredCommentsTitlePlural:"Editor's picks",showMore:"Show more comments",likeButton:"Recommend",unlikeButton:"Unrecommend",sortHotThreads:"Active discussions",sortBackButton:"Back to active discussions",sortTopComments:"Most recommended",moderator:"Moderator",postButton:"Submit Comment",postAsButton:"Submit Comment",postReplyButton:"Submit Comment",postReplyAsButton:"Submit Comment",topCommentsContentNotFoundMsg:"There aren't any recommendations yet.",errorLikeOwnComment:"You cannot recommend your own comment",shareDefaultText:"Read %s's comment on FT.com",commentTombstone:"This comment has been removed",flagButton:"Report",flagCommentTooltip:"Report",flagConfirmationMessage:"Report %s's comment as %s?",flagSubtitle:"Report as",flagSuccessMsg:"Comment has been reported.",flagTitle:"Report %s's comment",commentCountLabel:"COMMENTS (%s)",commentCountLabelPlural:"COMMENTS (%s)",editorDisabled:"This conversation is closed to new comments."}},function(e,t,n){"use strict";var o=n(7),i=n(5);t.trackPost=function(e,t){"number"==typeof e&&(i.trigger("event","oTracking",{category:"comment",action:"post",site_id:e,parent:t}),o.logger.debug("tracking - post",e,t))},t.trackLike=function(e){"number"==typeof e&&(i.trigger("event","oTracking",{category:"comment",action:"like",site_id:e}),o.logger.debug("tracking - like",e))},t.trackShare=function(e,t){"number"==typeof e&&"string"==typeof t&&(i.trigger("event","oTracking",{category:"comment",action:"share",site_id:e,platform:t}),o.logger.debug("tracking - share",e,t))},t.trackMention=function(e,t){"number"==typeof e&&"string"==typeof t&&(i.trigger("event","oTracking",{category:"comment",action:"mention",site_id:e,platform:t}),o.logger.debug("tracking - mention",e,t))};var r={emailcomments:"notifyComments",emailreplies:"notifyReplies",emaillikes:"notifyRecommends",emailautofollow:"autoFollow"};t.trackSubscribeToEmailAlert=function(e){for(var t={category:"comment",action:"follow"},n=void 0,s=0;s<e.length;s++)n=r[e[s]],n&&(t[n]=!0);i.trigger("event","oTracking",t),o.logger.debug("tracking - subscribe","follow=true&type=comment",e)},t.trackUnsubscribeFromEmailAlert=function(e){for(var t={category:"comment",action:"unfollow"},n=void 0,s=0;s<e.length;s++)n=r[e[s]],n&&(t[n]=!0);i.trigger("event","oTracking",t),o.logger.debug("tracking - unsubscribe","unfollow=true&type=comment",e)},t.trackSudsDown=function(){i.trigger("event","oTracking",{category:"component",action:"error",error:"commentsSUDSCommunication"}),o.logger.debug("tracking - suds down")},t.trackLivefyreDown=function(){i.trigger("event","oTracking",{category:"component",action:"error",error:"commentsLivefyreCommunication"}),o.logger.debug("tracking - livefyre down")},t.trackSuccessLoad=function(){i.trigger("event","oTracking",{category:"component",action:"load",component:"comments"}),o.logger.debug("tracking - success load")}},function(e,t){"use strict";t.on=function(e,t){document.body.addEventListener(e,t)},t.off=function(e,t){document.body.removeEventListener(e,t)},t.trigger=function(e,t){document.body.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0}))}},function(e,t,n){"use strict";var o=n(3),i=n(97);t.add=function(){o.on("tracking.subscribe",function(e){i.trackSubscribeToEmailAlert(e.detail)}),o.on("tracking.unsubscribe",function(e){i.trackUnsubscribeFromEmailAlert(e.detail)})}},function(e,t,n){"use strict";var o=n(3);t.trackPost=function(e,t){"number"==typeof e&&(Track.IJento.getSiTracker().sendAdditionalTracer("/si/comment","siteId="+e+(t?"&parent="+t:"")),o.utilities.logger.debug("tracking - post",e,t))},t.trackLike=function(e){"number"==typeof e&&(Track.IJento.getSiTracker().sendAdditionalTracer("/si/comment/like","siteId="+e),o.utilities.logger.debug("tracking - like",e))},t.trackShare=function(e,t){"number"==typeof e&&"string"==typeof t&&(Track.IJento.getSiTracker().sendAdditionalTracer("/si/comment/share","siteId="+e+"&platform="+t),o.utilities.logger.debug("tracking - share",e,t))},t.trackMention=function(e,t){"number"==typeof e&&"string"==typeof t&&(Track.IJento.getSiTracker().sendAdditionalTracer("/si/comment/mention","siteId="+e+"&platform="+t),o.utilities.logger.debug("tracking - mention",e,t))};var i={emailcomments:"notifyComments=true",emailreplies:"notifyReplies=true",emaillikes:"notifyRecommends=true",emailautofollow:"autoFollow=true"};t.trackSubscribeToEmailAlert=function(e){for(var t="",n=void 0,r=0;r<e.length;r++)n=i[e[r]],n&&(t+="&"+n);o.utilities.logger.debug("tracking - subscribe","follow=true&type=comment"+t),Track.IJento.getSiTracker().sendAdditionalTracer("/followme","follow=true&type=comment"+t)},t.trackUnsubscribeFromEmailAlert=function(e){for(var t="",n=void 0,r=0;r<e.length;r++)n=i[e[r]],n&&(t+="&"+n);o.utilities.logger.debug("tracking - unsubscribe","unfollow=true&type=comment"+t),Track.IJento.getSiTracker().sendAdditionalTracer("/followme","unfollow=true&type=comment"+t)},t.trackSudsDown=function(){Track.IJento.getSiTracker().sendAdditionalTracer("/eventonpage","type=codeError&data=commentsSUDSCommunication"),o.utilities.logger.debug("tracking - suds down")},t.trackLivefyreDown=function(){Track.IJento.getSiTracker().sendAdditionalTracer("/eventonpage","type=codeError&data=commentsLivefyreCommunication"),o.utilities.logger.debug("tracking - livefyre down")},t.trackSuccessLoad=function(){Track.IJento.getSiTracker().sendAdditionalTracer("/eventonpage","type=codeSuccess&data=commentsLoaded"),o.utilities.logger.debug("tracking - success load")}},function(e,t){"use strict";t.pollForBody=function(e){var t=setInterval(function(){document.body&&(clearInterval(t),e(document.body))},100)}},function(e,t,n){"use strict";function o(e){var t=void 0;if(e){e.autoInit=!1,t=document.getElementById(e.elId),delete e.elId,a.call(this,t,e);var n=this,o=this.getWidgetEl();this.getWidgetElJq=function(){return i.get().jQuery(o)},this.deferredLoad=function(){n.forceMode===!0?(a.utilities.logger.log("Force flag set, loading in forced mode."),n.init()):a.utils.isPermalinkPresent()?(a.utilities.logger.log("Permalink is present, widget loaded instantly."),n.init()):!function(){var e=new s(window),t=function(){a.utilities.logger.log("Scroll detected or widget area visible, widget loading now."),e.destroy(),n.init()};e.onElementReached(n.getWidgetElJq(),t,!0),e.onScrollStarts(t,!0)}()},this.instantLoad=function(){n.forceMode===!0&&a.utilities.logger.log("Force flag set, loading in forced mode."),n.init()};var u=!1;this.on("error.widget",function(e){var t=e.detail.data;(t&&!t.unclassifiedArticle||!t)&&(u||(u=!0,"undefined"==typeof Livefyre?r.trackLivefyreDown():r.trackSudsDown()))}),this.on("error.init",function(){u||(u=!0,r.trackSudsDown())}),this.on("widget.load",function(){r.trackSuccessLoad()}),this.on("widget.ready",function(){a.utilities.logger.log("load CSS overrides"),c.loadCssOverrides(i.get().stylesheetUrl)}),this.on("data.init",function(e){a.utilities.logger.debug("init data",e.detail.data)}),this.on("data.auth",function(e){a.utilities.logger.debug("auth data",e.detail.data)}),this.on("tracking.postComment",function(e){r.trackPost(e.detail.data.siteId,e.detail.data.lfEventData.parent),e.detail.data.lfEventData.sharedToFacebook===!0&&r.trackShare(e.detail.data.siteId,"facebook"),e.detail.data.lfEventData.sharedToTwitter===!0&&r.trackShare(e.detail.data.siteId,"twitter")}),this.on("tracking.likeComment",function(e){r.trackLike(e.detail.data.siteId)}),this.on("tracking.shareComment",function(e){e.detail.data.lfEventData.sharedToFacebook===!0&&r.trackShare(e.detail.data.siteId,"facebook"),e.detail.data.lfEventData.sharedToTwitter===!0&&r.trackShare(e.detail.data.siteId,"twitter")}),this.on("tracking.socialMention",function(e){r.trackMention(e.detail.data.siteId,e.detail.data.lfEventData.provider)}),this.on("widget.renderComplete",function(){n.trigger("initialRenderComplete.widget")}),l.on("loginRequired.authAction.ft",function(){n.trigger("loginRequired.authAction.ft",Array.prototype.slice.call(arguments,0))})}}var i=n(2),r=n(97),s=n(100),a=n(3),c=n(101),l=n(95);a.__extend(o),e.exports=o},function(e,t,n){"use strict";function o(e){function t(e,t){return(f?d.scrollTop():0)+d.height()>e.offset().top-(f?0:d.offset().top)-t&&(f?d.scrollTop():0)<e.offset().top-(f?0:d.offset().top)+e.height()+t}function n(e,t){return(f?d.scrollTop():0)+d.height()>e.offset().top-(f?0:d.offset().top)-t}function o(){m||(c.trigger("scroll."+p),c.trigger("scrollStarts."+p),s(),a())}function s(){var e=void 0,n=void 0,o=void 0;if(e=0,!m&&l&&l.length)for(;e<l.length;)n=l[e],o=0,t(n.element,n.pixelBefore)&&(n.callback(),n.once===!0&&(l.splice(e,1),o++)),e=e+1-o}function a(){var e=void 0,t=void 0,o=void 0;if(e=0,!m&&u&&u.length)for(;e<u.length;)t=u[e],o=0,n(t.element,t.pixelBefore)&&(t.callback(),t.once===!0&&(u.splice(e,1),o++)),e=e+1-o}var c=new r.utilities.Events,l=[],u=[],d=i.get().jQuery(e),f=!1,m=!1,p=Math.random().toString(36).substr(2,10);d.get(0)!==document&&d.get(0)!==window||(f=!0);var g=(new Date).getTime();d.bind("scroll."+p,function(){m||setTimeout(function(){!m&&d.scrollTop()>0?(new Date).getTime()-g>500&&(g=(new Date).getTime(),o.apply(this,arguments)):(s(),a())},100)}),this.onScroll=function(e,t){"function"!=typeof e||m||(t===!0?c.one("scroll."+p,e):c.on("scroll."+p,e))},this.onScrollStarts=function(e){"function"!=typeof e||m||c.one("scrollStarts."+p,e)},this.onElementVisible=function(e,n,o,r){"function"==typeof n&&e&&!m&&(l.push({element:i.get().jQuery(e),callback:n,pixelBefore:"number"===i.get().jQuery.type(o)&&o>0?o:0,once:r}),t(e,o)&&n())},this.onElementReached=function(e,t,o,r){"function"==typeof t&&e&&!m&&(u.push({element:i.get().jQuery(e),callback:t,pixelBefore:"number"===i.get().jQuery.type(o)&&o>0?o:0,once:r}),n(e,o)&&t())},this.destroy=function(){m||(c.off("scrollStarts."+p),c.off("scroll."+p),d.unbind("."+p),c=null,l=null,u=null,d=null,m=!0)}}var i=n(2),r=n(3);e.exports=o},function(e,t){"use strict";t.loadCssOverrides=function(){var e=[],t=document.head||document.getElementsByTagName("head")[0];return function(n){if(-1===e.indexOf(n)){e.push(n);var o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=n,t.appendChild(o)}}}()},function(e,t){e.exports={stylesheetUrl:"//www.ft-static.com/sp/prod/comments/3.14.0/long/ftcomIntegration.css",dependencies:{}}},function(e,t,n){"use strict";var o=n(3),i=n(2);e.exports=function(e){e.hasOwnProperty("dependencies")&&(e.dependencies.hasOwnProperty("o-comment-api")&&o.dataService.setConfig(e.dependencies["o-comment-api"]),e.dependencies.hasOwnProperty("o-comments")&&o.setConfig(e.dependencies["o-comments"]),delete e.dependencies),i.set(e),o.utilities.logger.disable(),e.logging&&(e.logging.enabled===!0&&o.utilities.logger.enable(),e.logging.level&&o.utilities.logger.setLevel(e.logging.level))}}]);